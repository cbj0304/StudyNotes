
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>设计模式 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../4工具类/" />
    
    
    <link rel="prev" href="正则表达式.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../">
            
                <a href="../">
            
                    
                    学习笔记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../1语言类/">
            
                <a href="../1语言类/">
            
                    
                    第一章--语言类
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../1语言类/c++11新特性.html">
            
                <a href="../1语言类/c++11新特性.html">
            
                    
                    c++11新特性
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../1语言类/STL.html">
            
                <a href="../1语言类/STL.html">
            
                    
                    STL标准模板库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../1语言类/python语言.html">
            
                <a href="../1语言类/python语言.html">
            
                    
                    python语言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../1语言类/shell脚本.html">
            
                <a href="../1语言类/shell脚本.html">
            
                    
                    shell脚本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../1语言类/libc函数库.html">
            
                <a href="../1语言类/libc函数库.html">
            
                    
                    libc函数库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../1语言类/R语言.html">
            
                <a href="../1语言类/R语言.html">
            
                    
                    R语言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../1语言类/mysql及索引优化.html">
            
                <a href="../1语言类/mysql及索引优化.html">
            
                    
                    mysql及索引优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../1语言类/gdb和makefile.html">
            
                <a href="../1语言类/gdb和makefile.html">
            
                    
                    gdb和makefile
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../2框架类/">
            
                <a href="../2框架类/">
            
                    
                    第二章--框架类
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../2框架类/flask框架.html">
            
                <a href="../2框架类/flask框架.html">
            
                    
                    flask框架
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../2框架类/scrapy框架_fake.html">
            
                <a href="../2框架类/scrapy框架_fake.html">
            
                    
                    scrapy框架
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../2框架类/brpc框架.html">
            
                <a href="../2框架类/brpc框架.html">
            
                    
                    brpc框架
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../2框架类/epoll_reactor.html">
            
                <a href="../2框架类/epoll_reactor.html">
            
                    
                    epoll_reactor
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="./">
            
                <a href="./">
            
                    
                    第三章--算法类
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="leetcode题型总结.html">
            
                <a href="leetcode题型总结.html">
            
                    
                    leetcode题型总结
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="数据结构_链表.html">
            
                <a href="数据结构_链表.html">
            
                    
                    数据结构_链表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="数据结构_树.html">
            
                <a href="数据结构_树.html">
            
                    
                    数据结构_树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="数据结构_图.html">
            
                <a href="数据结构_图.html">
            
                    
                    数据结构_图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="数据结构_堆_栈_队列.html">
            
                <a href="数据结构_堆_栈_队列.html">
            
                    
                    数据结构堆栈_队列
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="数据结构_字符串_哈希.html">
            
                <a href="数据结构_字符串_哈希.html">
            
                    
                    数据结构字符串哈希
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="数据结构_字典树_并查集_线段树.html">
            
                <a href="数据结构_字典树_并查集_线段树.html">
            
                    
                    数据结构字典树并查集_线段树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="算法_排序.html">
            
                <a href="算法_排序.html">
            
                    
                    算法_排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="算法_动态规划.html">
            
                <a href="算法_动态规划.html">
            
                    
                    算法_动态规划
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="算法_回溯.html">
            
                <a href="算法_回溯.html">
            
                    
                    算法_回溯
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.11" data-path="算法_搜索.html">
            
                <a href="算法_搜索.html">
            
                    
                    算法_搜索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.12" data-path="算法_贪心.html">
            
                <a href="算法_贪心.html">
            
                    
                    算法_贪心
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13" data-path="正则表达式.html">
            
                <a href="正则表达式.html">
            
                    
                    正则表达式
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.14" data-path="设计模式.html">
            
                <a href="设计模式.html">
            
                    
                    设计模式
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../4工具类/">
            
                <a href="../4工具类/">
            
                    
                    第四章--工具类
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../4工具类/vscode使用.html">
            
                <a href="../4工具类/vscode使用.html">
            
                    
                    vscode使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../4工具类/markdown语法.html">
            
                <a href="../4工具类/markdown语法.html">
            
                    
                    markdown语法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../5其他/">
            
                <a href="../5其他/">
            
                    
                    第五章--其他
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../5其他/学习代码.html">
            
                <a href="../5其他/学习代码.html">
            
                    
                    学习代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../5其他/学习网站.html">
            
                <a href="../5其他/学习网站.html">
            
                    
                    学习网站
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >设计模式</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>[TOC]</p>
<h1 id="&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;">&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;</h1>
<h1 id="&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x4E09;&#x5927;&#x7279;&#x6027;">&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x4E09;&#x5927;&#x7279;&#x6027;</h1>
<ul>
<li><p>&#x5C01;&#x88C5;&#x6027;</p>
<p>&#x5C01;&#x88C5;&#x5C31;&#x662F;&#x628A;&#x62BD;&#x8C61;&#x7684;&#x6570;&#x636E;&#x548C;&#x5BF9;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x7684;&#x64CD;&#x4F5C;&#x5C01;&#x88C5;&#x5728;&#x4E00;&#x8D77;&#x3002;&#xFF08;&#x4FDD;&#x62A4;&#x3001;&#x9694;&#x79BB;&#xFF09;</p>
</li>
<li><p>&#x7EE7;&#x627F;&#x6027;</p>
<p>&#x4ECE;&#x5DF2;&#x6709;&#x7C7B;&#x5F97;&#x5230;&#x7EE7;&#x627F;&#x4FE1;&#x606F;&#x521B;&#x5EFA;&#x65B0;&#x7C7B;&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#xFF08;&#x4EE3;&#x7801;&#x590D;&#x7528;&#xFF09;</p>
</li>
<li><p>&#x591A;&#x6001;&#x6027;</p>
<p>&#x7236;&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x6216;&#x6307;&#x9488;&#x6307;&#x5411;&#x4E0D;&#x540C;&#x7684;&#x5B50;&#x7C7B;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x8C03;&#x7528;&#x540C;&#x6837;&#x7684;&#x65B9;&#x6CD5;&#x4F46;&#x662F;&#x505A;&#x4E86;&#x4E0D;&#x540C;&#x7684;&#x4E8B;&#x60C5;&#x3002;&#xFF08;&#x591A;&#x79CD;&#x72B6;&#x6001;&#xFF09;<br>overload&#xFF1A;&#x91CD;&#x8F7D;&#xFF08;&#x540C;&#x4E00;&#x4E2A;&#x7C7B;&#x4E2D;&#xFF0C;&#x51FD;&#x6570;&#x540D;&#x76F8;&#x540C;&#xFF0C;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x548C;&#x4E2A;&#x6570;&#x4E0D;&#x540C;&#xFF09;&#xFF1A;&#x5B9E;&#x73B0;&#x7F16;&#x8BD1;&#x65F6;&#x591A;&#x6001;&#xFF0C;&#x5373;&#x524D;&#x7ED1;&#x5B9A;&#x3002;<br>override&#xFF1A;&#x91CD;&#x5199;&#xFF08;&#x5B50;&#x7C7B;&#x5BF9;&#x7236;&#x7C7B;&#x4E2D;&#x7684;&#x865A;&#x51FD;&#x6570;&#x7684;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF09;&#xFF1A;&#x5B9E;&#x73B0;&#x8FD0;&#x884C;&#x65F6;&#x7ED1;&#x5B9A;&#xFF0C;&#x5373;&#x540E;&#x7ED1;&#x5B9A;&#x3002;  </p>
</li>
</ul>
<h1 id="&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x516B;&#x5927;&#x8BBE;&#x8BA1;&#x539F;&#x5219;">&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x516B;&#x5927;&#x8BBE;&#x8BA1;&#x539F;&#x5219;</h1>
<h2 id="&#x4F9D;&#x8D56;&#x5012;&#x7F6E;&#x539F;&#x5219;">&#x4F9D;&#x8D56;&#x5012;&#x7F6E;&#x539F;&#x5219;</h2>
<ul>
<li><p>&#x7A0B;&#x5E8F;&#x8981;&#x4F9D;&#x8D56;&#x4E8E;&#x62BD;&#x8C61;&#x63A5;&#x53E3;&#xFF0C;&#x4E0D;&#x8981;&#x4F9D;&#x8D56;&#x4E8E;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x3002;<br>&#x9AD8;&#x5C42;&#x6A21;&#x5757;&#xFF08;&#x7A33;&#x5B9A;&#xFF09;&#x4E0D;&#x5E94;&#x8BE5;&#x4F9D;&#x8D56;&#x4E8E;&#x4F4E;&#x5C42;&#x6A21;&#x5757;&#xFF08;&#x53D8;&#x5316;&#xFF09;&#xFF0C;&#x4E8C;&#x8005;&#x90FD;&#x5E94;&#x8BE5;&#x4F9D;&#x8D56;&#x4E8E;&#x62BD;&#x8C61;&#xFF08;&#x7A33;&#x5B9A;&#xFF09;&#xFF1B;  </p>
<blockquote>
<p>AutoSystem&#x7CFB;&#x7EDF;&#xFF08;&#x9AD8;&#x5C42;&#x4E1A;&#x52A1;&#x6A21;&#x5757;&#xFF09;&#x4F9D;&#x8D56;&#x4E8E;ICar &#x8FD9;&#x4E2A;&#x62BD;&#x8C61;&#xFF0C;&#x800C;&#x4E0E;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x73B0;&#x7EC6;&#x8282;HondaCar&#x3001;FordCar&#x3001;BmwCar&#x65E0;&#x5173;&#xFF0C;&#x6240;&#x4EE5;&#x5B9E;&#x73B0;&#x7EC6;&#x8282;&#x7684;&#x53D8;&#x5316;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;AutoSystem&#x3002;  </p>
</blockquote>
</li>
<li><p>&#x62BD;&#x8C61;&#x4E0D;&#x5E94;&#x8BE5;&#x4F9D;&#x8D56;&#x4E8E;&#x5B9E;&#x73B0;&#x7EC6;&#x8282;&#xFF08;&#x53D8;&#x5316;&#xFF09;&#xFF0C;&#x5B9E;&#x73B0;&#x7EC6;&#x8282;&#x5E94;&#x8BE5;&#x4F9D;&#x8D56;&#x4E8E;&#x62BD;&#x8C61;&#xFF1B;  </p>
<blockquote>
<p>&#x5BF9;&#x4E8E;&#x5B9E;&#x73B0;&#x7EC6;&#x8282;HondaCar&#x3001;FordCar&#x3001;BmwCar &#x53EA;&#x8981;&#x5B9E;&#x73B0;ICar&#x5373;&#x53EF;&#xFF0C;&#x5373;&#x5B9E;&#x73B0;&#x7EC6;&#x8282;&#x4F9D;&#x8D56;&#x4E8E;ICar&#x62BD;&#x8C61;&#x3002;  </p>
</blockquote>
</li>
<li><p>&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#xFF1A;  </p>
<pre><code class="lang-c++"><span class="hljs-comment">// &#x62BD;&#x8C61;&#x63A5;&#x53E3;&#x7C7B;</span>
<span class="hljs-keyword">class</span> ICar
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Run</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Turn</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Stop</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
};

<span class="hljs-comment">// &#x5177;&#x4F53;&#x5B9E;&#x73B0; - &#x5B9D;&#x9A6C;&#x8F66;</span>
<span class="hljs-keyword">class</span> BmwCar : <span class="hljs-keyword">public</span> ICar
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Run</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;BmwCar run&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Turn</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;BmwCar turn&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Stop</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;BmwCar stop&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-comment">// &#x5177;&#x4F53;&#x5B9E;&#x73B0; - &#x798F;&#x7279;&#x8F66;</span>
<span class="hljs-keyword">class</span> FordCar : <span class="hljs-keyword">public</span> ICar
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Run</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;FordCar run&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Turn</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;FordCar turn&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Stop</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;FordCar stop&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};
<span class="hljs-comment">/*
&#x5982;&#x679C;&#x589E;&#x52A0;&#x8F66;&#x7684;&#x54C1;&#x724C;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x5177;&#x4F53;&#x8F66;&#x578B;&#x5373;&#x53EF;
class HondaCar : public ICar
{
public:
};*/</span>

<span class="hljs-comment">// &#x9AD8;&#x5C42;&#x63A7;&#x5236;&#x6A21;&#x5757;</span>
<span class="hljs-keyword">class</span> AutoSystem
{
<span class="hljs-keyword">private</span>:
    ICar *_icar;

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RunCar</span><span class="hljs-params">()</span> </span>{
        _icar-&gt;Run();
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TurnCar</span><span class="hljs-params">()</span> </span>{
        _icar-&gt;Turn();
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">StopCar</span><span class="hljs-params">()</span> </span>{
        _icar-&gt;Stop();
    }
<span class="hljs-keyword">public</span>:
    AutoSystem(ICar* icar) {
        <span class="hljs-keyword">this</span>-&gt;_icar = icar;
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">testCar</span><span class="hljs-params">()</span> </span>{
        RunCar();
        TurnCar();
        StopCar();
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// &#x591A;&#x6001;&#x8C03;&#x7528;&#xFF08;&#x52A8;&#x6001;&#x7ED1;&#x5B9A;&#xFF09;</span>
    ICar *car = <span class="hljs-keyword">new</span> BmwCar();
    AutoSystem au = AutoSystem(car);
    au.testCar();
    system(<span class="hljs-string">&quot;pause&quot;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
</li>
</ul>
<h2 id="&#x5F00;&#x653E;&#x5C01;&#x95ED;&#x539F;&#x5219;&#xFF08;ocp">&#x5F00;&#x653E;&#x5C01;&#x95ED;&#x539F;&#x5219;&#xFF08;OCP)</h2>
<p>&#x200B;   &#x5BF9;&#x6269;&#x5C55;&#x5F00;&#x653E;&#xFF0C;&#x5BF9;&#x4FEE;&#x6539;&#x5C01;&#x95ED;&#xFF1B;</p>
<h2 id="&#x5355;&#x4E00;&#x804C;&#x8D23;&#x539F;&#x5219;">&#x5355;&#x4E00;&#x804C;&#x8D23;&#x539F;&#x5219;</h2>
<p>&#x200B;   &#x4E00;&#x4E2A;&#x7C7B;&#x5E94;&#x8BE5;&#x4EC5;&#x6709;&#x4E00;&#x4E2A;&#x5F15;&#x8D77;&#x53D8;&#x5316;&#x7684;&#x539F;&#x56E0;&#xFF1B;&#x53D8;&#x5316;&#x7684;&#x65B9;&#x5411;&#x9690;&#x542B;&#x7740;&#x7C7B;&#x7684;&#x8D23;&#x4EFB;&#xFF1B;</p>
<h2 id="&#x91CC;&#x6C0F;&#xFF08;liskov&#xFF09;&#x66FF;&#x6362;&#x539F;&#x5219;">&#x91CC;&#x6C0F;&#xFF08;Liskov&#xFF09;&#x66FF;&#x6362;&#x539F;&#x5219;</h2>
<ul>
<li><strong>&#x5B9A;&#x4E49;</strong>&#xFF1A;&#x7236;&#x7C7B;&#x51FA;&#x73B0;&#x7684;&#x5730;&#x65B9;&#x53EF;&#x4EE5;&#x88AB;&#x5B50;&#x7C7B;&#x66FF;&#x6362;&#xFF0C;&#x5728;&#x66FF;&#x6362;&#x540E;&#x4F9D;&#x7136;&#x4FDD;&#x6301;&#x539F;&#x529F;&#x80FD;&#x3002;  </li>
<li><strong>&#x5B9E;&#x73B0;</strong>&#xFF1A;&#x5B50;&#x7C7B;&#x5FC5;&#x987B;&#x5B8C;&#x5168;&#x5B9E;&#x73B0;&#x7236;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x5B50;&#x7C7B;&#x62E5;&#x6709;&#x7236;&#x7C7B;&#x7684;&#x6240;&#x6709;&#x529F;&#x80FD;&#x3002;  </li>
<li><strong>&#x4F5C;&#x7528;</strong>&#xFF1A;&#x589E;&#x5F3A;&#x7A0B;&#x5E8F;&#x7684;&#x5065;&#x58EE;&#x6027;&#xFF0C;&#x7248;&#x672C;&#x5347;&#x7EA7;&#x65F6;&#x4E5F;&#x53EF;&#x4EE5;&#x4FDD;&#x6301;&#x975E;&#x5E38;&#x597D;&#x7684;&#x517C;&#x5BB9;&#x6027;&#x3002;&#x5373;&#x4F7F;&#x589E;&#x52A0;&#x5B50;&#x7C7B;&#xFF0C;&#x539F;&#x6709;&#x7684;&#x5B50;&#x7C7B;&#x8FD8;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x3002;&#x5728;&#x5B9E;&#x9645;&#x9879;&#x76EE;&#x4E2D;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B50;&#x7C7B;&#x5BF9;&#x5E94;&#x4E0D;&#x540C;&#x7684;&#x4E1A;&#x52A1;&#x542B;&#x4E49;&#xFF0C;&#x4F7F;&#x7528;&#x7236;&#x7C7B;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#xFF0C;&#x4F20;&#x9012;&#x4E0D;&#x540C;&#x7684;&#x5B50;&#x7C7B;&#x5B8C;&#x6210;&#x4E0D;&#x540C;&#x7684;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#xFF08;&#x591A;&#x6001;&#xFF09;&#x3002;  </li>
</ul>
<h2 id="&#x63A5;&#x53E3;&#x9694;&#x79BB;&#x539F;&#x5219;">&#x63A5;&#x53E3;&#x9694;&#x79BB;&#x539F;&#x5219;</h2>
<p>&#x200B;   &#x5BA2;&#x6237;&#x7AEF;&#x4E0D;&#x5E94;&#x8BE5;&#x4F9D;&#x8D56;&#x5B83;&#x4E0D;&#x9700;&#x8981;&#x7684;&#x63A5;&#x53E3;&#xFF1B;&#x4E00;&#x4E2A;&#x7C7B;&#x5BF9;&#x53E6;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x4F9D;&#x8D56;&#x5E94;&#x8BE5;&#x5EFA;&#x7ACB;&#x5728;&#x6700;&#x5C0F;&#x7684;&#x63A5;&#x53E3;&#x4E0A;&#x3002;&#x4F7F;&#x7528;&#x591A;&#x4E2A;&#x4E13;&#x95E8;&#x7684;&#x63A5;&#x53E3;&#x6BD4;&#x4F7F;&#x7528;&#x5355;&#x4E00;&#x7684;&#x603B;&#x63A5;&#x53E3;&#x8981;&#x597D;&#x3002;  </p>
<h2 id="&#x4F18;&#x5148;&#x4F7F;&#x7528;&#x5BF9;&#x8C61;&#x7EC4;&#x5408;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x7C7B;&#x7EE7;&#x627F;">&#x4F18;&#x5148;&#x4F7F;&#x7528;&#x5BF9;&#x8C61;&#x7EC4;&#x5408;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x7C7B;&#x7EE7;&#x627F;</h2>
<p>&#x200B;   &#x7EE7;&#x627F;&#x548C;&#x7EC4;&#x5408;&#x90FD;&#x80FD;&#x8FBE;&#x5230;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x590D;&#x7528;&#x7684;&#x6548;&#x679C;&#xFF0C;&#x4F46;&#x662F;&#x7C7B;&#x7684;&#x7EE7;&#x627F;&#x901A;&#x5E38;&#x662F;&#x767D;&#x7BB1;&#x590D;&#x7528;&#xFF0C;&#x5BF9;&#x8C61;&#x7EC4;&#x5408;&#x901A;&#x5E38;&#x4E3A;&#x9ED1;&#x7BB1;&#x590D;&#x7528;&#x3002;
&#x6211;&#x4EEC;&#x5728;&#x4F7F;&#x7528;&#x7EE7;&#x627F;&#x7684;&#x65F6;&#x5019;&#x540C;&#x65F6;&#x4E5F;&#x5C31;&#x62E5;&#x6709;&#x4E86;&#x7236;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x4FDD;&#x62A4;&#x6210;&#x5458;&#xFF0C;&#x589E;&#x52A0;&#x4E86;&#x8026;&#x5408;&#x5EA6;&#x3002;<br>&#x800C;&#x5BF9;&#x8C61;&#x7EC4;&#x5408;&#x5C31;&#x53EA;&#x9700;&#x8981;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x63A5;&#x53E3;&#x7A33;&#x5B9A;&#xFF0C;&#x8026;&#x5408;&#x5EA6;&#x4F4E;&#x3002;<br>&#x7EE7;&#x627F;&#xFF08;is a&#xFF09;<br>&#x7EC4;&#x5408;&#xFF08;has a&#xFF09;  </p>
<h2 id="&#x5C01;&#x88C5;&#x53D8;&#x5316;&#x70B9;">&#x5C01;&#x88C5;&#x53D8;&#x5316;&#x70B9;</h2>
<p>&#x200B;   &#x5C06;&#x7CFB;&#x7EDF;&#x4E2D;&#x7ECF;&#x5E38;&#x53D8;&#x5316;&#x7684;&#x90E8;&#x5206;&#x548C;&#x7A33;&#x5B9A;&#x7684;&#x90E8;&#x5206;&#x9694;&#x79BB;&#xFF0C;&#x6709;&#x52A9;&#x4E8E;&#x589E;&#x52A0;&#x590D;&#x7528;&#x6027;&#xFF0C;&#x5E76;&#x964D;&#x4F4E;&#x7CFB;&#x7EDF;&#x8026;&#x5408;&#x5EA6;&#x3002;  </p>
<h2 id="&#x9488;&#x5BF9;&#x63A5;&#x53E3;&#x7F16;&#x7A0B;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x9488;&#x5BF9;&#x5B9E;&#x73B0;&#x7F16;&#x7A0B;">&#x9488;&#x5BF9;&#x63A5;&#x53E3;&#x7F16;&#x7A0B;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x9488;&#x5BF9;&#x5B9E;&#x73B0;&#x7F16;&#x7A0B;</h2>
<ul>
<li><p><strong>&#x672C;&#x8D28;</strong>&#xFF1A;&#x591A;&#x6001;&#x6027;&#x7684;&#x8FD0;&#x7528;&#x3002;
&#x63A5;&#x53E3;&#xFF08;&#x5982;&#x865A;&#x57FA;&#x7C7B;&#xFF09;&#xFF0C;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x5806;&#x7A7A;&#x65B9;&#x6CD5;&#xFF0C;&#x662F;&#x5BF9;&#x5176;&#x5168;&#x90E8;&#x5B9E;&#x73B0;&#x7C7B;&#x7684;&#x7EA6;&#x675F;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x5FC5;&#x987B;&#x5B9E;&#x73B0;&#x63A5;&#x53E3;&#x4E8B;&#x5148;&#x89C4;&#x5B9A;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5DF2;&#x4F7F;&#x5F97;&#x518D;&#x64CD;&#x7EB5;&#x7236;&#x7C7B;&#x63A5;&#x53E3;&#xFF08;&#x6307;&#x5411;&#x5B50;&#x7C7B;&#x5B9E;&#x73B0;&#xFF09;&#x65F6;&#xFF0C;&#x83B7;&#x5F97;&#x79CD;&#x64CD;&#x4F5C;&#x4E0A;&#x7684;&#x4E00;&#x81F4;&#x6027;&#xFF08;&#x591A;&#x6001;&#xFF09;&#xFF0C;&#x800C;&#x5FFD;&#x89C6;&#x5176;&#x5B50;&#x7C7B;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x4E0A;&#x7684;&#x5DEE;&#x5F02;&#x3002;&#x800C;&#x9488;&#x5BF9;&#x63A5;&#x53E3;&#x7F16;&#x7A0B;&#xFF0C;&#x4F20;&#x9012;&#x7684;&#x5219;&#x662F;&#x7236;&#x7C7B;&#x5F15;&#x7528;/&#x6307;&#x9488;&#xFF0C;&#x8FD9;&#x6837;&#x4FBF;&#x53EF;&#x53D1;&#x6325;&#x591A;&#x6001;&#x6027;&#x201C;&#x7236;&#x7C7B;&#x5F15;&#x7528;&#x6307;&#x5411;&#x5B50;&#x7C7B;&#x5BF9;&#x8C61;&#x201D;&#x7684;&#x7279;&#x70B9;&#x548C;&#x4F18;&#x52BF;&#xFF1B;<br>&#x9488;&#x5BF9;&#x5B9E;&#x73B0;&#x7F16;&#x7A0B;&#xFF1A;Dog *pDog = new DogClass(); pDog.Bark();<br>&#x9488;&#x5BF9;&#x63A5;&#x53E3;&#x7F16;&#x7A0B;&#xFF1A;Animal *pAnimal = new DogClass(); pAnimal.Bark();  </p>
</li>
<li><p><strong>&#x4EE3;&#x7801;&#x793A;&#x4F8B;</strong>&#xFF1A;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; cstdlib&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">// &#x62BD;&#x8C61;&#x63A5;&#x53E3;</span>
<span class="hljs-keyword">class</span> Animal{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Bark</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
};

<span class="hljs-comment">// &#x5177;&#x4F53;&#x5B9E;&#x73B0;Dog</span>
<span class="hljs-keyword">class</span> Dog : <span class="hljs-keyword">public</span> Animal {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Bark</span><span class="hljs-params">()</span></span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;dog bark...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-comment">// &#x5177;&#x4F53;&#x5B9E;&#x73B0;Cat</span>
<span class="hljs-keyword">class</span> Cat : <span class="hljs-keyword">public</span> Animal {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Bark</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;cat bark...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">// &#x591A;&#x6001;&#x8C03;&#x7528;</span>
    Animal *pAnimal = <span class="hljs-keyword">new</span> Dog();
    pAnimal-&gt;Bark();  

    system(<span class="hljs-string">&quot;pause&quot;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
</li>
</ul>
<h1 id="&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;23&#x79CD;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;">&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;23&#x79CD;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;</h1>
<h2 id="&#x521B;&#x5EFA;&#x578B;&#x6A21;&#x5F0F;&#xFF08;5&#x79CD;&#xFF09;">&#x521B;&#x5EFA;&#x578B;&#x6A21;&#x5F0F;&#xFF08;5&#x79CD;&#xFF09;</h2>
<p>&#x200B;   &#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x5316;&#x7684;&#x6A21;&#x5F0F;&#xFF0C;&#x7528;&#x4E8E;&#x89E3;&#x8026;&#x5BF9;&#x8C61;&#x7684;&#x5B9E;&#x4F8B;&#x5316;&#x8FC7;&#x7A0B;&#x3002;</p>
<h3 id="&#x5DE5;&#x5382;&#x6A21;&#x5F0F;">&#x5DE5;&#x5382;&#x6A21;&#x5F0F;</h3>
<ul>
<li>&#x5934;&#x6587;&#x4EF6;</li>
</ul>
<pre><code class="lang-c++"><span class="hljs-comment">// factorymethod.h</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; cstdlib&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">//=============================&#x62BD;&#x8C61;&#x57FA;&#x7C7B;</span>
<span class="hljs-keyword">class</span> ISplitter{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-comment">// &#x62BD;&#x8C61;&#x57FA;&#x7C7B;&#x5FC5;&#x987B;&#x81EA;&#x5B9A;&#x4E49;&#x62BD;&#x8C61;&#x7684;&#x6790;&#x6784;&#x51FD;&#x6570;</span>
    <span class="hljs-keyword">virtual</span> ~ISplitter(){}
};

<span class="hljs-comment">//=============================&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x57FA;&#x7C7B;</span>
<span class="hljs-keyword">class</span> SplitterFactory{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> ISplitter* <span class="hljs-title">CreateSplitter</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">virtual</span> ~SplitterFactory(){}
};

<span class="hljs-comment">//=============================&#x5177;&#x4F53;&#x7C7B;</span>
<span class="hljs-comment">// &#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;&#x5206;&#x5272;&#x5668;</span>
<span class="hljs-keyword">class</span> BinarySplitter : <span class="hljs-keyword">public</span> ISplitter{
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">()</span> </span>{ <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;BinarySplitter...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>; }
};

<span class="hljs-comment">// &#x6587;&#x672C;&#x6587;&#x4EF6;&#x5206;&#x5272;&#x5668;</span>
<span class="hljs-keyword">class</span> TxtSplitter: <span class="hljs-keyword">public</span> ISplitter{
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">()</span> </span>{ <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;TxtSplitter...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>; }
};

<span class="hljs-comment">// &#x56FE;&#x7247;&#x5206;&#x5272;&#x5668;</span>
<span class="hljs-keyword">class</span> PictureSplitter: <span class="hljs-keyword">public</span> ISplitter{
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">()</span> </span>{ <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;PictureSplitter...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>; }
};

<span class="hljs-keyword">class</span> VideoSplitter: <span class="hljs-keyword">public</span> ISplitter{
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">()</span> </span>{ <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;VideoSplitter...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>; }
};

<span class="hljs-comment">//=============================&#x5177;&#x4F53;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;</span>
<span class="hljs-keyword">class</span> BinarySplitterFactory: <span class="hljs-keyword">public</span> SplitterFactory{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> ISplitter* <span class="hljs-title">CreateSplitter</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> BinarySplitter();
    }
};

<span class="hljs-keyword">class</span> TxtSplitterFactory: <span class="hljs-keyword">public</span> SplitterFactory{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> ISplitter* <span class="hljs-title">CreateSplitter</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TxtSplitter();
    }
};

<span class="hljs-keyword">class</span> PictureSplitterFactory: <span class="hljs-keyword">public</span> SplitterFactory{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> ISplitter* <span class="hljs-title">CreateSplitter</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> PictureSplitter();
    }
};

<span class="hljs-keyword">class</span> VideoSplitterFactory: <span class="hljs-keyword">public</span> SplitterFactory{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> ISplitter* <span class="hljs-title">CreateSplitter</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> VideoSplitter();
    }
};
</code></pre>
<ul>
<li>&#x6E90;&#x6587;&#x4EF6;</li>
</ul>
<pre><code class="lang-c++">// factorymethod.cpp
#include &quot;1_factorymethod.h&quot;

class MainForm
{
    SplitterFactory*  factory;//&#x5DE5;&#x5382;

public:
    MainForm(SplitterFactory*  factory){
        this-&gt;factory=factory;
    }

    void ButtonClick(){
        ISplitter * splitter=
            factory-&gt;CreateSplitter(); //&#x591A;&#x6001;new

        splitter-&gt;split();

    }
};

int main()
{

    MainForm m1(new PictureSplitterFactory());
    m1.ButtonClick();

    MainForm m2(new TxtSplitterFactory());
    m2.ButtonClick();

    // TODO &#x8003;&#x8651;&#x5806;&#x8D44;&#x6E90;&#x91CA;&#x653E; delete
    system(&quot;pause&quot;);
    return 0;
}
</code></pre>
<h3 id="&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;">&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// abstract.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; vector&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">//&#x6570;&#x636E;&#x5E93;&#x8BBF;&#x95EE;&#x6709;&#x5173;&#x7684;&#x57FA;&#x7C7B;</span>
<span class="hljs-keyword">class</span> IDBConnection{

};

<span class="hljs-keyword">class</span> IDBCommand{

};

<span class="hljs-keyword">class</span> IDataReader{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">read</span><span class="hljs-params">()</span> </span>{ <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;IDataReader&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>; }
};

<span class="hljs-keyword">class</span> IDBFactory{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> IDBConnection* <span class="hljs-title">CreateDBConnection</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> IDBCommand* <span class="hljs-title">CreateDBCommand</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> IDataReader* <span class="hljs-title">CreateDataReader</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;

   IDBFactory() {}
    <span class="hljs-keyword">virtual</span> ~IDBFactory() {}
};

<span class="hljs-comment">//&#x652F;&#x6301;SQL Server</span>
<span class="hljs-keyword">class</span> SqlConnection: <span class="hljs-keyword">public</span> IDBConnection{

};
<span class="hljs-keyword">class</span> SqlCommand: <span class="hljs-keyword">public</span> IDBCommand{

};
<span class="hljs-keyword">class</span> SqlDataReader: <span class="hljs-keyword">public</span> IDataReader{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">read</span><span class="hljs-params">()</span> </span>{ <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;SqlDataReader&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>; }
};

<span class="hljs-keyword">class</span> SqlDBFactory:<span class="hljs-keyword">public</span> IDBFactory{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function">IDBConnection* <span class="hljs-title">CreateDBConnection</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SqlConnection();
    }
    <span class="hljs-function">IDBCommand* <span class="hljs-title">CreateDBCommand</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SqlCommand();
    }
    <span class="hljs-function">IDataReader* <span class="hljs-title">CreateDataReader</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SqlDataReader();
    }

    SqlDBFactory() {}
    ~SqlDBFactory() {}
};

<span class="hljs-comment">//&#x652F;&#x6301;Oracle</span>
<span class="hljs-keyword">class</span> OracleConnection: <span class="hljs-keyword">public</span> IDBConnection{

};

<span class="hljs-keyword">class</span> OracleCommand: <span class="hljs-keyword">public</span> IDBCommand{

};

<span class="hljs-keyword">class</span> OracleDataReader: <span class="hljs-keyword">public</span> IDataReader{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">read</span><span class="hljs-params">()</span> </span>{ <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;OracleDataReader&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>; }
};

<span class="hljs-keyword">class</span> OracleDBFactory:<span class="hljs-keyword">public</span> IDBFactory{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function">IDBConnection* <span class="hljs-title">CreateDBConnection</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> OracleConnection();
    }
    <span class="hljs-function">IDBCommand* <span class="hljs-title">CreateDBCommand</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> OracleCommand();
    }
    <span class="hljs-function">IDataReader* <span class="hljs-title">CreateDataReader</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> OracleDataReader();
    }

    OracleDBFactory() {}
    ~OracleDBFactory() {}
};

<span class="hljs-keyword">class</span> EmployeeDAO {
    IDBFactory* m_dbFactory;

<span class="hljs-keyword">public</span>:

    EmployeeDAO(IDBFactory* dbFactory) {
        <span class="hljs-keyword">this</span>-&gt;m_dbFactory=dbFactory;
    }
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; GetEmployees(){
        IDBConnection* connection =
            m_dbFactory-&gt;CreateDBConnection();
        <span class="hljs-comment">// connection-&gt;ConnectionString(&quot;...&quot;);</span>

        IDBCommand* command =
            m_dbFactory-&gt;CreateDBCommand();
        <span class="hljs-comment">// command-&gt;CommandText(&quot;...&quot;);</span>
        <span class="hljs-comment">// command-&gt;SetConnection(connection); //&#x5173;&#x8054;&#x6027;</span>

        IDataReader* reader =
            m_dbFactory-&gt;CreateDataReader(); <span class="hljs-comment">//&#x5173;&#x8054;&#x6027;</span>
        <span class="hljs-comment">// read ...</span>
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    IDBFactory *idf = <span class="hljs-keyword">new</span> OracleDBFactory();
    IDataReader* ir = idf-&gt;CreateDataReader();
    ir-&gt;read();
    <span class="hljs-comment">// EmployeeDAO dao(idf);</span>
    <span class="hljs-comment">// dao.GetEmployees();</span>

    <span class="hljs-keyword">if</span>(idf) {
        <span class="hljs-keyword">delete</span> idf;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#xFF08;singleton&#xFF09;">&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#xFF08;singleton&#xFF09;</h3>
<ul>
<li><p>c++&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x5206;&#x4E3A;&#x4E24;&#x79CD;&#xFF1A;&#x61D2;&#x6C49;&#x6A21;&#x5F0F;&#x548C;&#x997F;&#x6C49;&#x6A21;&#x5F0F;  </p>
<ul>
<li>&#x61D2;&#x6C49;&#x6A21;&#x5F0F;&#xFF1A;&#x7B2C;&#x4E00;&#x6B21;&#x7528;&#x7684;&#x65F6;&#x5019;&#x624D;&#x4F1A;&#x521B;&#x5EFA;&#xFF0C;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;  </li>
<li>&#x997F;&#x6C49;&#x6A21;&#x5F0F;&#xFF1A;&#x4E00;&#x5F00;&#x59CB;&#x5C31;&#x52A0;&#x8F7D;&#xFF0C;&#x7A7A;&#x95F4;&#x6362;&#x65F6;&#x95F4;&#xFF0C;&#x6BCF;&#x6B21;&#x7528;&#x7684;&#x65F6;&#x5019;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#xFF0C;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;  </li>
<li>&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x662F;&#x5728;&#x61D2;&#x6C49;&#x57FA;&#x7840;&#x4E0A;&#x52A0;&#x9501;&#x3001;double-check&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x8FD9;&#x4E2D;&#x65B9;&#x5F0F;&#x7531;&#x4E8E;cpu&#x6307;&#x4EE4;reorder&#x4F1A;&#x5BFC;&#x81F4;&#x4E0D;&#x53EF;&#x9884;&#x77E5;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E0D;&#x63A8;&#x8350;  </li>
</ul>
<p><strong>&#x5934;&#x6587;&#x4EF6;&#xFF1A;</strong></p>
<pre><code class="lang-c++"><span class="hljs-comment">// singleton.h</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">// c++&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x5206;&#x4E3A;&#x4E24;&#x79CD;&#xFF1A;&#x61D2;&#x6C49;&#x6A21;&#x5F0F;&#x548C;&#x997F;&#x6C49;&#x6A21;&#x5F0F;</span>
<span class="hljs-comment">// &#x61D2;&#x6C49;&#x6A21;&#x5F0F;&#xFF1A;&#x7B2C;&#x4E00;&#x6B21;&#x7528;&#x7684;&#x65F6;&#x5019;&#x624D;&#x4F1A;&#x521B;&#x5EFA;&#xFF0C;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;</span>
<span class="hljs-comment">// &#x997F;&#x6C49;&#x6A21;&#x5F0F;&#xFF1A;&#x4E00;&#x5F00;&#x59CB;&#x5C31;&#x52A0;&#x8F7D;&#xFF0C;&#x7A7A;&#x95F4;&#x6362;&#x65F6;&#x95F4;&#xFF0C;&#x6BCF;&#x6B21;&#x7528;&#x7684;&#x65F6;&#x5019;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#xFF0C;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;</span>
<span class="hljs-comment">// &#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x662F;&#x5728;&#x61D2;&#x6C49;&#x57FA;&#x7840;&#x4E0A;&#x52A0;&#x9501;&#x3001;double-check&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x8FD9;&#x4E2D;&#x65B9;&#x5F0F;&#x7531;&#x4E8E;cpu&#x6307;&#x4EE4;reorder&#x4F1A;&#x5BFC;&#x81F4;&#x4E0D;&#x53EF;&#x9884;&#x77E5;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E0D;&#x63A8;&#x8350;</span>

<span class="hljs-comment">// &#x61D2;&#x6C49;&#xFF08;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#xFF09;</span>
<span class="hljs-keyword">class</span> Singleton_ {
<span class="hljs-keyword">private</span>:
    Singleton_() {}
    <span class="hljs-keyword">static</span> Singleton_ *single_;
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">static</span> Singleton_* <span class="hljs-title">GetInstance</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (single_ == <span class="hljs-literal">NULL</span>) {
            single_ = <span class="hljs-keyword">new</span> Singleton_();
        }
        <span class="hljs-keyword">return</span> single_;
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-keyword">int</span> data)</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Singleton_ print =&gt; &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-comment">// Singleton_ * Singleton_::single_ = NULL;</span>

<span class="hljs-comment">// &#x997F;&#x6C49;&#xFF08;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF09;</span>

<span class="hljs-keyword">class</span> Singleton {
<span class="hljs-keyword">private</span>:
    <span class="hljs-comment">// &#x6784;&#x9020;&#x51FD;&#x6570;&#x79C1;&#x6709;&#x5316;</span>
    Singleton() {}
    <span class="hljs-keyword">static</span> Singleton *single;

<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">static</span> Singleton* <span class="hljs-title">GetInstance</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> single;
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-keyword">int</span> data)</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Singleton_ print =&gt; &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-comment">// Singleton *Singleton::single = new Singleton();</span>
</code></pre>
<p><strong>&#x6E90;&#x6587;&#x4EF6;&#xFF1A;</strong></p>
<pre><code class="lang-c++"><span class="hljs-comment">// singleton.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-string">&quot;3_singleton.h&quot;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; pthread.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; cstdlib&gt;</span></span>

<span class="hljs-comment">// &#x61D2;&#x6C49;&#x521D;&#x59CB;&#x5316;</span>
Singleton_ *Singleton_::single_ = <span class="hljs-literal">NULL</span>;

<span class="hljs-comment">// &#x997F;&#x6C49;&#x521D;&#x59CB;&#x5316;</span>
Singleton *Singleton::single = <span class="hljs-keyword">new</span> Singleton();

<span class="hljs-function"><span class="hljs-keyword">void</span> *<span class="hljs-title">threadFunc</span><span class="hljs-params">(<span class="hljs-keyword">void</span> * arg)</span></span>{
    <span class="hljs-keyword">int</span>* pnum = (<span class="hljs-keyword">int</span> *)arg;
    Singleton::GetInstance()-&gt;print(*pnum);
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">void</span> *)<span class="hljs-number">0</span>;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span>
</span>{
    <span class="hljs-keyword">pthread_t</span> tids[<span class="hljs-number">5</span>];
    <span class="hljs-keyword">int</span> thread_data[<span class="hljs-number">5</span>]={<span class="hljs-number">111</span>, <span class="hljs-number">222</span>, <span class="hljs-number">333</span>, <span class="hljs-number">444</span>, <span class="hljs-number">555</span>};
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; ++i) {
        <span class="hljs-keyword">int</span> ret = pthread_create(&amp;tids[i], <span class="hljs-literal">NULL</span>, threadFunc, (<span class="hljs-keyword">void</span> *)(&amp;thread_data[i]));
        <span class="hljs-keyword">if</span>(ret) {
            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;pthread err:&quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-built_in">endl</span>;
            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
        }
    }

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">5</span>; ++j) {
        pthread_join(tids[j], <span class="hljs-literal">NULL</span>);
    }

    system(<span class="hljs-string">&quot;pause&quot;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
</li>
</ul>
<h3 id="&#x5EFA;&#x9020;&#x8005;&#x6A21;&#x5F0F;">&#x5EFA;&#x9020;&#x8005;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// builder.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">// &#x57FA;&#x7C7B;</span>
<span class="hljs-keyword">class</span> House {
    <span class="hljs-comment">//....</span>
};

<span class="hljs-comment">// &#x57FA;&#x7C7B;builder</span>
<span class="hljs-keyword">class</span> HouseBuilder {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function">House* <span class="hljs-title">GetResult</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> pHouse;
    }
    <span class="hljs-keyword">virtual</span> ~HouseBuilder(){}

    House* pHouse;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildPart1</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildPart2</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">BuildPart3</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildPart4</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildPart5</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;

};

<span class="hljs-comment">// &#x5177;&#x4F53;&#x7C7B;</span>
<span class="hljs-keyword">class</span> StoneHouse: <span class="hljs-keyword">public</span> House{

};

<span class="hljs-comment">// &#x5177;&#x4F53;&#x7C7B;&#x7684;builder</span>
<span class="hljs-keyword">class</span> StoneHouseBuilder: <span class="hljs-keyword">public</span> HouseBuilder{
<span class="hljs-keyword">public</span>:

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildPart1</span><span class="hljs-params">()</span></span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;StoneHouseBuilder BuildPart1...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildPart2</span><span class="hljs-params">()</span></span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;StoneHouseBuilder BuildPart2...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">BuildPart3</span><span class="hljs-params">()</span></span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;StoneHouseBuilder BuildPart3...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildPart4</span><span class="hljs-params">()</span></span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;StoneHouseBuilder BuildPart4...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildPart5</span><span class="hljs-params">()</span></span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;StoneHouseBuilder BuildPart5...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }

};

<span class="hljs-keyword">class</span> HouseDirector{

<span class="hljs-keyword">public</span>:
    HouseBuilder* pHouseBuilder;

    HouseDirector(HouseBuilder* pHouseBuilder){
        <span class="hljs-keyword">this</span>-&gt;pHouseBuilder=pHouseBuilder;
    }

    <span class="hljs-function">House* <span class="hljs-title">Construct</span><span class="hljs-params">()</span></span>{

        pHouseBuilder-&gt;BuildPart1();

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++){
            pHouseBuilder-&gt;BuildPart2();
        }

        <span class="hljs-keyword">bool</span> flag=pHouseBuilder-&gt;BuildPart3();

        <span class="hljs-keyword">if</span>(flag){
            pHouseBuilder-&gt;BuildPart4();
        }

        pHouseBuilder-&gt;BuildPart5();

        <span class="hljs-keyword">return</span> pHouseBuilder-&gt;GetResult();
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    HouseBuilder* pHB = <span class="hljs-keyword">new</span> StoneHouseBuilder();
    <span class="hljs-function">HouseDirector <span class="hljs-title">hd</span><span class="hljs-params">(pHB)</span></span>;
    hd.Construct();

    <span class="hljs-comment">// &#x91CA;&#x653E;&#x5806;&#x5185;&#x5B58;</span>
    <span class="hljs-keyword">if</span> (pHB) {
        <span class="hljs-keyword">delete</span> pHB;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<h3 id="&#x539F;&#x578B;&#x6A21;&#x5F0F;">&#x539F;&#x578B;&#x6A21;&#x5F0F;</h3>
<p><strong>&#x5934;&#x6587;&#x4EF6;&#xFF1A;</strong></p>
<pre><code class="lang-c++"><span class="hljs-comment">// prototype.h</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">//&#x62BD;&#x8C61;&#x7C7B;</span>
<span class="hljs-keyword">class</span> ISplitter{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> ISplitter* <span class="hljs-title">clone</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>; <span class="hljs-comment">//&#x901A;&#x8FC7;&#x514B;&#x9686;&#x81EA;&#x5DF1;&#x6765;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;</span>

    <span class="hljs-keyword">virtual</span> ~ISplitter(){}
};

<span class="hljs-comment">//&#x5177;&#x4F53;&#x7C7B;</span>
<span class="hljs-keyword">class</span> BinarySplitter : <span class="hljs-keyword">public</span> ISplitter{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> ISplitter* <span class="hljs-title">clone</span><span class="hljs-params">()</span></span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;BinarySplitter clone...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> BinarySplitter(*<span class="hljs-keyword">this</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;BinarySplitter split...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-keyword">class</span> TxtSplitter: <span class="hljs-keyword">public</span> ISplitter{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> ISplitter* <span class="hljs-title">clone</span><span class="hljs-params">()</span></span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;TxtSplitter clone...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TxtSplitter(*<span class="hljs-keyword">this</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;TxtSplitter split...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-keyword">class</span> PictureSplitter: <span class="hljs-keyword">public</span> ISplitter{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> ISplitter* <span class="hljs-title">clone</span><span class="hljs-params">()</span></span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;PictureSplitter clone...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> PictureSplitter(*<span class="hljs-keyword">this</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;PictureSplitter split...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};
</code></pre>
<p><strong>&#x6E90;&#x6587;&#x4EF6;&#xFF1A;</strong></p>
<pre><code class="lang-c++"><span class="hljs-comment">// prototype.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-string">&quot;prototype.h&quot;</span></span>

<span class="hljs-keyword">class</span> MainForm
{
    ISplitter*  prototype;<span class="hljs-comment">//&#x539F;&#x578B;&#x5BF9;&#x8C61;</span>

<span class="hljs-keyword">public</span>:

    MainForm(ISplitter* prototype){
        <span class="hljs-keyword">this</span>-&gt;prototype=prototype;
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ButtonClick</span><span class="hljs-params">()</span></span>{

        ISplitter * splitter = prototype-&gt;clone(); <span class="hljs-comment">//&#x514B;&#x9686;&#x539F;&#x578B;</span>

        splitter-&gt;split();
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    ISplitter *is = <span class="hljs-keyword">new</span> PictureSplitter();
    <span class="hljs-function">MainForm <span class="hljs-title">mf</span><span class="hljs-params">(is)</span></span>;

    mf.ButtonClick();

    <span class="hljs-keyword">delete</span> is;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x7ED3;&#x6784;&#x578B;&#x6A21;&#x5F0F;&#xFF08;7&#x79CD;&#xFF09;">&#x7ED3;&#x6784;&#x578B;&#x6A21;&#x5F0F;&#xFF08;7&#x79CD;&#xFF09;</h2>
<p>&#x200B;   &#x628A;&#x7C7B;&#x6216;&#x5BF9;&#x8C61;&#x7ED3;&#x5408;&#x5728;&#x4E00;&#x8D77;&#x5F62;&#x6210;&#x4E00;&#x4E2A;&#x66F4;&#x5927;&#x7684;&#x7ED3;&#x6784;&#x3002;</p>
<h3 id="&#x9002;&#x914D;&#x5668;&#x6A21;&#x5F0F;">&#x9002;&#x914D;&#x5668;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// adapter.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">//&#x76EE;&#x6807;&#x63A5;&#x53E3;&#xFF08;&#x65B0;&#x63A5;&#x53E3;&#xFF09;</span>
<span class="hljs-keyword">class</span> ITarget{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
};

<span class="hljs-comment">//&#x9057;&#x7559;&#x63A5;&#x53E3;&#xFF08;&#x8001;&#x63A5;&#x53E3;&#xFF09;</span>
<span class="hljs-keyword">class</span> IAdaptee{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">int</span> data)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">bar</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
};

<span class="hljs-comment">//&#x9057;&#x7559;&#x7C7B;&#x578B;</span>
<span class="hljs-keyword">class</span> OldClass: <span class="hljs-keyword">public</span> IAdaptee{
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">int</span> data)</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;old foo.. data=&quot;</span>  &lt;&lt; data &lt;&lt; <span class="hljs-built_in">endl</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">bar</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;old bar...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">10</span>;
    }
};

<span class="hljs-comment">//&#x5BF9;&#x8C61;&#x9002;&#x914D;&#x5668;(&#x7EE7;&#x627F;&#x81EA;ITarget&#xFF0C;&#x5C31;&#x8981;&#x5B9E;&#x73B0;ITarget&#x7684;&#x63A5;&#x53E3;&#x89C4;&#x8303;)</span>
<span class="hljs-keyword">class</span> Adapter: <span class="hljs-keyword">public</span> ITarget{ <span class="hljs-comment">//&#x7EE7;&#x627F;</span>
<span class="hljs-keyword">protected</span>:
    IAdaptee* pAdaptee;<span class="hljs-comment">//&#x7EC4;&#x5408;</span>

<span class="hljs-keyword">public</span>:

    Adapter(IAdaptee* pAdaptee){
        <span class="hljs-keyword">this</span>-&gt;pAdaptee=pAdaptee;
    }

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">int</span> data=pAdaptee-&gt;bar();
        pAdaptee-&gt;foo(data);
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    IAdaptee* pAdaptee=<span class="hljs-keyword">new</span> OldClass();
    ITarget* pTarget=<span class="hljs-keyword">new</span> Adapter(pAdaptee);
    pTarget-&gt;process();
}
</code></pre>
<h3 id="&#x88C5;&#x9970;&#x5668;&#x6A21;&#x5F0F;">&#x88C5;&#x9970;&#x5668;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// decorator.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">// &#x6587;&#x4EF6;&#x6D41;&#x3001;&#x7F51;&#x7EDC;&#x6D41;&#x3001;&#x5185;&#x5B58;&#x6D41; &#x90FD;&#x7EE7;&#x627F;&#x81EA;&#x6D41;&#x57FA;&#x7C7B;  &lt;- &#x62BD;&#x8C61;</span>
<span class="hljs-comment">// &#x52A0;&#x5BC6;&#x3001;&#x7F13;&#x5B58; &#x90FD;&#x662F;&#x5BF9;&#x6D41;&#x7684;&#x4FEE;&#x9970;              &lt;- &#x88C5;&#x9970;</span>
<span class="hljs-comment">// &#x88C5;&#x9970;&#x6A21;&#x5F0F;&#x4EE5;&#x5BF9;&#x5BA2;&#x6237;&#x7AEF;&#x900F;&#x660E;&#x7684;&#x65B9;&#x5F0F;&#x6269;&#x5C55;&#x5BF9;&#x8C61;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x662F;&#x7EE7;&#x627F;&#x5173;&#x7CFB;&#x7684;&#x4E00;&#x4E2A;&#x66FF;&#x4EE3;&#x65B9;&#x6848;&#xFF0C;&#x6BD4;&#x7EE7;&#x627F;&#x66F4;&#x7075;&#x6D3B;&#x3002;&#x52A8;&#x6001;&#x7ED9;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x589E;&#x52A0;&#xFF08;&#x64A4;&#x9500;&#xFF09;&#x529F;&#x80FD;&#x3002;</span>
<span class="hljs-comment">// &#x5B9E;&#x73B0;&#xFF1A;&#x7EE7;&#x627F;(is a) + &#x7EC4;&#x5408;(has a)</span>

<span class="hljs-comment">//&#x4E1A;&#x52A1;&#x64CD;&#x4F5C;</span>
<span class="hljs-keyword">class</span> Stream{

<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">char</span> <span class="hljs-title">Read</span><span class="hljs-params">(<span class="hljs-keyword">int</span> number)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Seek</span><span class="hljs-params">(<span class="hljs-keyword">int</span> position)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Write</span><span class="hljs-params">(<span class="hljs-keyword">char</span> data)</span></span>=<span class="hljs-number">0</span>;

    <span class="hljs-keyword">virtual</span> ~Stream(){}
};

<span class="hljs-comment">//&#x4E3B;&#x4F53;&#x7C7B;</span>
<span class="hljs-keyword">class</span> FileStream: <span class="hljs-keyword">public</span> Stream{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">char</span> <span class="hljs-title">Read</span><span class="hljs-params">(<span class="hljs-keyword">int</span> number)</span></span>{
        <span class="hljs-comment">//&#x8BFB;&#x6587;&#x4EF6;&#x6D41;</span>
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;File Read...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Seek</span><span class="hljs-params">(<span class="hljs-keyword">int</span> position)</span></span>{
        <span class="hljs-comment">//&#x5B9A;&#x4F4D;&#x6587;&#x4EF6;&#x6D41;</span>
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;File Seek...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Write</span><span class="hljs-params">(<span class="hljs-keyword">char</span> data)</span></span>{
        <span class="hljs-comment">//&#x5199;&#x6587;&#x4EF6;&#x6D41;</span>
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;File Write...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }

};

<span class="hljs-keyword">class</span> NetworkStream :<span class="hljs-keyword">public</span> Stream{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">char</span> <span class="hljs-title">Read</span><span class="hljs-params">(<span class="hljs-keyword">int</span> number)</span></span>{
        <span class="hljs-comment">//&#x8BFB;&#x7F51;&#x7EDC;&#x6D41;</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Seek</span><span class="hljs-params">(<span class="hljs-keyword">int</span> position)</span></span>{
        <span class="hljs-comment">//&#x5B9A;&#x4F4D;&#x7F51;&#x7EDC;&#x6D41;</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Write</span><span class="hljs-params">(<span class="hljs-keyword">char</span> data)</span></span>{
        <span class="hljs-comment">//&#x5199;&#x7F51;&#x7EDC;&#x6D41;</span>
    }
};

<span class="hljs-keyword">class</span> MemoryStream :<span class="hljs-keyword">public</span> Stream{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">char</span> <span class="hljs-title">Read</span><span class="hljs-params">(<span class="hljs-keyword">int</span> number)</span></span>{
        <span class="hljs-comment">//&#x8BFB;&#x5185;&#x5B58;&#x6D41;</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Seek</span><span class="hljs-params">(<span class="hljs-keyword">int</span> position)</span></span>{
        <span class="hljs-comment">//&#x5B9A;&#x4F4D;&#x5185;&#x5B58;&#x6D41;</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Write</span><span class="hljs-params">(<span class="hljs-keyword">char</span> data)</span></span>{
        <span class="hljs-comment">//&#x5199;&#x5185;&#x5B58;&#x6D41;</span>
    }
};

<span class="hljs-comment">//&#x6269;&#x5C55;&#x64CD;&#x4F5C;</span>

<span class="hljs-keyword">class</span> DecoratorStream: <span class="hljs-keyword">public</span> Stream{
<span class="hljs-keyword">protected</span>:
    Stream* stream;<span class="hljs-comment">//...</span>
    DecoratorStream(Stream * stm):stream(stm){  
    }
};

<span class="hljs-keyword">class</span> CryptoStream: <span class="hljs-keyword">public</span> DecoratorStream {

<span class="hljs-keyword">public</span>:
    CryptoStream(Stream* stm):DecoratorStream(stm){

    }

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">char</span> <span class="hljs-title">Read</span><span class="hljs-params">(<span class="hljs-keyword">int</span> number)</span></span>{

        <span class="hljs-comment">//&#x989D;&#x5916;&#x7684;&#x52A0;&#x5BC6;&#x64CD;&#x4F5C;...</span>
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Crypto Read...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        stream-&gt;Read(number);<span class="hljs-comment">//&#x8BFB;&#x6587;&#x4EF6;&#x6D41;</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Seek</span><span class="hljs-params">(<span class="hljs-keyword">int</span> position)</span></span>{
        <span class="hljs-comment">//&#x989D;&#x5916;&#x7684;&#x52A0;&#x5BC6;&#x64CD;&#x4F5C;...</span>
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Crypto Seek...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        stream-&gt;Seek(position);<span class="hljs-comment">//&#x5B9A;&#x4F4D;&#x6587;&#x4EF6;&#x6D41;</span>
        <span class="hljs-comment">//&#x989D;&#x5916;&#x7684;&#x52A0;&#x5BC6;&#x64CD;&#x4F5C;...</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Write</span><span class="hljs-params">(<span class="hljs-keyword">char</span> data)</span></span>{
        <span class="hljs-comment">//&#x989D;&#x5916;&#x7684;&#x52A0;&#x5BC6;&#x64CD;&#x4F5C;...</span>
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Crypto Write...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        stream-&gt;Write(data);<span class="hljs-comment">//&#x5199;&#x6587;&#x4EF6;&#x6D41;</span>
        <span class="hljs-comment">//&#x989D;&#x5916;&#x7684;&#x52A0;&#x5BC6;&#x64CD;&#x4F5C;...</span>
    }
};

<span class="hljs-keyword">class</span> BufferedStream : <span class="hljs-keyword">public</span> DecoratorStream{

<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// &#x8C03;&#x7528;&#x7236;&#x7C7B;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;</span>
    BufferedStream(Stream* stm):DecoratorStream(stm){

    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">char</span> <span class="hljs-title">Read</span><span class="hljs-params">(<span class="hljs-keyword">int</span> number)</span></span>{

        <span class="hljs-comment">//&#x989D;&#x5916;&#x7684;&#x52A0;&#x5BC6;&#x64CD;&#x4F5C;...</span>
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Buffered Read...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        stream-&gt;Read(number);<span class="hljs-comment">//&#x8BFB;&#x6587;&#x4EF6;&#x6D41;</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Seek</span><span class="hljs-params">(<span class="hljs-keyword">int</span> position)</span></span>{
        <span class="hljs-comment">//&#x989D;&#x5916;&#x7684;&#x52A0;&#x5BC6;&#x64CD;&#x4F5C;...</span>
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Buffered Seek...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        stream-&gt;Seek(position);<span class="hljs-comment">//&#x5B9A;&#x4F4D;&#x6587;&#x4EF6;&#x6D41;</span>
        <span class="hljs-comment">//&#x989D;&#x5916;&#x7684;&#x52A0;&#x5BC6;&#x64CD;&#x4F5C;...</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Write</span><span class="hljs-params">(<span class="hljs-keyword">char</span> data)</span></span>{
        <span class="hljs-comment">//&#x989D;&#x5916;&#x7684;&#x52A0;&#x5BC6;&#x64CD;&#x4F5C;...</span>
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Buffered Write...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        stream-&gt;Write(data);<span class="hljs-comment">//&#x5199;&#x6587;&#x4EF6;&#x6D41;</span>
        <span class="hljs-comment">//&#x989D;&#x5916;&#x7684;&#x52A0;&#x5BC6;&#x64CD;&#x4F5C;...</span>
    }

};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span>{
    <span class="hljs-comment">// &#x8FD0;&#x884C;&#x65F6;&#x88C5;&#x914D;</span>
    <span class="hljs-keyword">int</span> num = <span class="hljs-number">100</span>;
    FileStream* s1=<span class="hljs-keyword">new</span> FileStream();
    s1-&gt;Read(num);

    CryptoStream* s2=<span class="hljs-keyword">new</span> CryptoStream(s1);
    s2-&gt;Read(num);

    BufferedStream* s3=<span class="hljs-keyword">new</span> BufferedStream(s1);
    s3-&gt;Read(num);

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x4EE3;&#x7406;&#x6A21;&#x5F0F;">&#x4EE3;&#x7406;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// proxy.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">// &#x4EE3;&#x7406;&#x6A21;&#x5F0F;&#xFF1A;&#x4E3A;&#x5176;&#x4ED6;&#x5BF9;&#x8C61;&#x63D0;&#x4F9B;&#x4E00;&#x79CD;&#x4EE3;&#x7406;&#x4EE5;&#x63A7;&#x5236;&#x5BF9;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x8BBF;&#x95EE;&#x3002;&#x8FD9;&#x6837;&#x5B9E;&#x73B0;&#x4E86;&#x4E1A;&#x52A1;&#x548C;&#x6838;&#x5FC3;&#x529F;&#x80FD;&#x5206;&#x79BB;&#x3002;</span>
<span class="hljs-comment">// &#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#x548C;&#x771F;&#x5B9E;&#x5BF9;&#x8C61;&#x6709;&#x76F8;&#x540C;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x53EF;&#x4EE5;&#x64CD;&#x4F5C;&#x771F;&#x5B9E;&#x5BF9;&#x8C61;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x9644;&#x52A0;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#xFF0C;&#x5BF9;&#x771F;&#x5B9E;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x4E86;&#x5C01;&#x88C5;&#x548C;&#x9694;&#x79BB;&#x3002;</span>
<span class="hljs-comment">// &#x5E94;&#x7528;&#xFF1A;&#x8FDC;&#x7A0B;&#x4EE3;&#x7406;(&#x5982;rpc)&#x3001;&#x5B89;&#x5168;&#x4EE3;&#x7406;&#xFF08;&#x63A7;&#x5236;&#x771F;&#x5B9E;&#x5BF9;&#x8C61;&#x7684;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#xFF09;&#x3001;&#x667A;&#x80FD;&#x6307;&#x9488;&#xFF08;&#x53EF;&#x4EE5;&#x5904;&#x7406;&#x771F;&#x5B9E;&#x6307;&#x9488;&#x5916;&#x7684;&#x4E00;&#x4E9B;&#x4E8B;&#x60C5;&#xFF09;</span>

<span class="hljs-comment">// &#x62BD;&#x8C61;&#x63A5;&#x53E3;</span>
<span class="hljs-keyword">class</span> Subject {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Request</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-keyword">virtual</span> ~Subject(){}
};

<span class="hljs-comment">// &#x771F;&#x5B9E;&#x5BF9;&#x8C61;</span>
<span class="hljs-keyword">class</span> RealSubject : <span class="hljs-keyword">public</span> Subject {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Request</span><span class="hljs-params">()</span> </span>{ <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;RealSubject&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>; }
};

<span class="hljs-comment">// &#x4EE3;&#x7406;&#x5BF9;&#x8C61;</span>
<span class="hljs-keyword">class</span> Proxy : <span class="hljs-keyword">public</span> Subject {
<span class="hljs-keyword">private</span>:
    RealSubject* realSubject;
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Request</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (realSubject == <span class="hljs-literal">NULL</span>) realSubject = <span class="hljs-keyword">new</span> RealSubject();
        <span class="hljs-comment">// &#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x5904;&#x589E;&#x52A0;&#x5BF9;&#x771F;&#x5B9E;&#x5BF9;&#x8C61;&#x7684;&#x7279;&#x6B8A;&#x5904;&#x7406;&#x6216;&#x590D;&#x6742;&#x7684;&#x4E1A;&#x52A1;&#x89C4;&#x5219;</span>
        realSubject-&gt;Request();
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    Subject* p = <span class="hljs-keyword">new</span> Proxy();
    p-&gt;Request(); <span class="hljs-comment">// RealSubject</span>

    <span class="hljs-keyword">delete</span> p;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x5916;&#x89C2;&#x6A21;&#x5F0F;">&#x5916;&#x89C2;&#x6A21;&#x5F0F;</h3>
<p>&#x4E5F;&#x53EB;&#x5916;&#x89C2;&#x6A21;&#x5F0F;&#xFF0C;Facade Pattern</p>
<h3 id="&#x6865;&#x63A5;&#x6A21;&#x5F0F;">&#x6865;&#x63A5;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// bridge1.cpp</span>
<span class="hljs-keyword">class</span> Messager{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Login</span><span class="hljs-params">(<span class="hljs-built_in">string</span> username, <span class="hljs-built_in">string</span> password)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendMessage</span><span class="hljs-params">(<span class="hljs-built_in">string</span> message)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendPicture</span><span class="hljs-params">(Image image)</span></span>=<span class="hljs-number">0</span>;

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PlaySound</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawShape</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WriteText</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Connect</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;

    <span class="hljs-keyword">virtual</span> ~Messager(){}
};

<span class="hljs-comment">//&#x5E73;&#x53F0;&#x5B9E;&#x73B0;</span>

<span class="hljs-keyword">class</span> PCMessagerBase : <span class="hljs-keyword">public</span> Messager{
<span class="hljs-keyword">public</span>:

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PlaySound</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//**********</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawShape</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//**********</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WriteText</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//**********</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Connect</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//**********</span>
    }
};

<span class="hljs-keyword">class</span> MobileMessagerBase : <span class="hljs-keyword">public</span> Messager{
<span class="hljs-keyword">public</span>:

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PlaySound</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//==========</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawShape</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//==========</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WriteText</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//==========</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Connect</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//==========</span>
    }
};

<span class="hljs-comment">//&#x4E1A;&#x52A1;&#x62BD;&#x8C61;</span>

<span class="hljs-keyword">class</span> PCMessagerLite : <span class="hljs-keyword">public</span> PCMessagerBase {
<span class="hljs-keyword">public</span>:

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Login</span><span class="hljs-params">(<span class="hljs-built_in">string</span> username, <span class="hljs-built_in">string</span> password)</span></span>{

        PCMessagerBase::Connect();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendMessage</span><span class="hljs-params">(<span class="hljs-built_in">string</span> message)</span></span>{

        PCMessagerBase::WriteText();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendPicture</span><span class="hljs-params">(Image image)</span></span>{

        PCMessagerBase::DrawShape();
        <span class="hljs-comment">//........</span>
    }
};

<span class="hljs-keyword">class</span> PCMessagerPerfect : <span class="hljs-keyword">public</span> PCMessagerBase {
<span class="hljs-keyword">public</span>:

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Login</span><span class="hljs-params">(<span class="hljs-built_in">string</span> username, <span class="hljs-built_in">string</span> password)</span></span>{

        PCMessagerBase::PlaySound();
        <span class="hljs-comment">//********</span>
        PCMessagerBase::Connect();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendMessage</span><span class="hljs-params">(<span class="hljs-built_in">string</span> message)</span></span>{

        PCMessagerBase::PlaySound();
        <span class="hljs-comment">//********</span>
        PCMessagerBase::WriteText();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendPicture</span><span class="hljs-params">(Image image)</span></span>{

        PCMessagerBase::PlaySound();
        <span class="hljs-comment">//********</span>
        PCMessagerBase::DrawShape();
        <span class="hljs-comment">//........</span>
    }
};

<span class="hljs-keyword">class</span> MobileMessagerLite : <span class="hljs-keyword">public</span> MobileMessagerBase {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Login</span><span class="hljs-params">(<span class="hljs-built_in">string</span> username, <span class="hljs-built_in">string</span> password)</span></span>{

        MobileMessagerBase::Connect();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendMessage</span><span class="hljs-params">(<span class="hljs-built_in">string</span> message)</span></span>{

        MobileMessagerBase::WriteText();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendPicture</span><span class="hljs-params">(Image image)</span></span>{

        MobileMessagerBase::DrawShape();
        <span class="hljs-comment">//........</span>
    }
};

<span class="hljs-keyword">class</span> MobileMessagerPerfect : <span class="hljs-keyword">public</span> MobileMessagerBase {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Login</span><span class="hljs-params">(<span class="hljs-built_in">string</span> username, <span class="hljs-built_in">string</span> password)</span></span>{

        MobileMessagerBase::PlaySound();
        <span class="hljs-comment">//********</span>
        MobileMessagerBase::Connect();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendMessage</span><span class="hljs-params">(<span class="hljs-built_in">string</span> message)</span></span>{

        MobileMessagerBase::PlaySound();
        <span class="hljs-comment">//********</span>
        MobileMessagerBase::WriteText();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendPicture</span><span class="hljs-params">(Image image)</span></span>{

        MobileMessagerBase::PlaySound();
        <span class="hljs-comment">//********</span>
        MobileMessagerBase::DrawShape();
        <span class="hljs-comment">//........</span>
    }
};

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Process</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//&#x7F16;&#x8BD1;&#x65F6;&#x88C5;&#x914D;</span>
        Messager *m =
            <span class="hljs-keyword">new</span> MobileMessagerPerfect();
}
</code></pre>
<pre><code class="lang-c++"><span class="hljs-comment">// bridge2.cpp</span>
<span class="hljs-keyword">class</span> Messager{
<span class="hljs-keyword">protected</span>:
     MessagerImp* messagerImp;<span class="hljs-comment">//...</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Login</span><span class="hljs-params">(<span class="hljs-built_in">string</span> username, <span class="hljs-built_in">string</span> password)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendMessage</span><span class="hljs-params">(<span class="hljs-built_in">string</span> message)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendPicture</span><span class="hljs-params">(Image image)</span></span>=<span class="hljs-number">0</span>;

    <span class="hljs-keyword">virtual</span> ~Messager(){}
};

<span class="hljs-keyword">class</span> MessagerImp{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PlaySound</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawShape</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WriteText</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Connect</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-title">MessagerImp</span><span class="hljs-params">()</span></span>{}
};

<span class="hljs-comment">//&#x5E73;&#x53F0;&#x5B9E;&#x73B0; n</span>
<span class="hljs-keyword">class</span> PCMessagerImp : <span class="hljs-keyword">public</span> MessagerImp{
<span class="hljs-keyword">public</span>:

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PlaySound</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//**********</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawShape</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//**********</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WriteText</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//**********</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Connect</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//**********</span>
    }
};

<span class="hljs-keyword">class</span> MobileMessagerImp : <span class="hljs-keyword">public</span> MessagerImp{
<span class="hljs-keyword">public</span>:

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PlaySound</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//==========</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawShape</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//==========</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WriteText</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//==========</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Connect</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//==========</span>
    }
};

<span class="hljs-comment">//&#x4E1A;&#x52A1;&#x62BD;&#x8C61; m</span>

<span class="hljs-comment">//&#x7C7B;&#x7684;&#x6570;&#x76EE;&#xFF1A;1+n+m</span>

<span class="hljs-keyword">class</span> MessagerLite :<span class="hljs-keyword">public</span> Messager {

<span class="hljs-keyword">public</span>:

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Login</span><span class="hljs-params">(<span class="hljs-built_in">string</span> username, <span class="hljs-built_in">string</span> password)</span></span>{

        messagerImp-&gt;Connect();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendMessage</span><span class="hljs-params">(<span class="hljs-built_in">string</span> message)</span></span>{

        messagerImp-&gt;WriteText();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendPicture</span><span class="hljs-params">(Image image)</span></span>{

        messagerImp-&gt;DrawShape();
        <span class="hljs-comment">//........</span>
    }
};

<span class="hljs-keyword">class</span> MessagerPerfect  :<span class="hljs-keyword">public</span> Messager {

<span class="hljs-keyword">public</span>:

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Login</span><span class="hljs-params">(<span class="hljs-built_in">string</span> username, <span class="hljs-built_in">string</span> password)</span></span>{

        messagerImp-&gt;PlaySound();
        <span class="hljs-comment">//********</span>
        messagerImp-&gt;Connect();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendMessage</span><span class="hljs-params">(<span class="hljs-built_in">string</span> message)</span></span>{

        messagerImp-&gt;PlaySound();
        <span class="hljs-comment">//********</span>
        messagerImp-&gt;WriteText();
        <span class="hljs-comment">//........</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendPicture</span><span class="hljs-params">(Image image)</span></span>{

        messagerImp-&gt;PlaySound();
        <span class="hljs-comment">//********</span>
        messagerImp-&gt;DrawShape();
        <span class="hljs-comment">//........</span>
    }
};

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Process</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">//&#x8FD0;&#x884C;&#x65F6;&#x88C5;&#x914D;</span>
    MessagerImp* mImp=<span class="hljs-keyword">new</span> PCMessagerImp();
    Messager *m =<span class="hljs-keyword">new</span> Messager(mImp);
}
</code></pre>
<h3 id="&#x7EC4;&#x5408;&#x6A21;&#x5F0F;">&#x7EC4;&#x5408;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// composite.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; list&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; string&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; algorithm&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-keyword">class</span> Component
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-keyword">virtual</span> ~Component(){}
};

<span class="hljs-comment">// &#x6811;&#x8282;&#x70B9;</span>
<span class="hljs-comment">// &#x7EE7;&#x627F; + &#x7EC4;&#x5408;</span>
<span class="hljs-comment">// &#x7EE7;&#x627F; -- &#x662F;&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x7236;&#x7C7B;&#x5B9A;&#x4E49;&#x7684;&#x63A5;&#x53E3;&#x89C4;&#x8303;&#xFF0C;&#x4E0D;&#x7EE7;&#x627F;&#x751F;&#x6B7B;&#xFF08;&#x6784;&#x9020;&#x51FD;&#x6570;&#x548C;&#x6790;&#x6784;&#x51FD;&#x6570;&#xFF09;</span>
<span class="hljs-comment">// &#x7EC4;&#x5408; -- &#x662F;&#x540C;&#x65F6;&#x5305;&#x542B;&#x5E76;&#x5904;&#x7406;&#x591A;&#x4E2A;Component &#x7C7B;&#x578B;</span>
<span class="hljs-keyword">class</span> Composite : <span class="hljs-keyword">public</span> Component{

    <span class="hljs-built_in">string</span> name;
    <span class="hljs-built_in">list</span>&lt;Component*&gt; elements;
<span class="hljs-keyword">public</span>:
    Composite(<span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> &amp; s) : name(s) {}

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(Component* element)</span> </span>{
        elements.push_back(element);
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(Component* element)</span></span>{
        <span class="hljs-built_in">list</span>&lt;Component*&gt;::iterator it = find(elements.begin(), elements.end(), element);
        <span class="hljs-keyword">if</span> (it != elements.end()) {
            elements.erase(it);
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">()</span></span>{

        <span class="hljs-comment">//1. process current node</span>

        <span class="hljs-comment">//2. process leaf nodes</span>
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;composite process... name=&gt;&quot;</span> &lt;&lt; name &lt;&lt; <span class="hljs-built_in">endl</span>;  
        <span class="hljs-built_in">list</span>&lt;Component*&gt;::iterator it = elements.begin();
        <span class="hljs-keyword">for</span> (;it != elements.end();it++) {
            (*it)-&gt;process(); <span class="hljs-comment">//&#x591A;&#x6001;&#x8C03;&#x7528;</span>
        }
    }
};

<span class="hljs-comment">//&#x53F6;&#x5B50;&#x8282;&#x70B9;</span>
<span class="hljs-keyword">class</span> Leaf : <span class="hljs-keyword">public</span> Component{
    <span class="hljs-built_in">string</span> name;
<span class="hljs-keyword">public</span>:
    Leaf(<span class="hljs-built_in">string</span> s) : name(s) {}

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//process current node</span>
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;leaf process name=&gt;&quot;</span> &lt;&lt; name &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Invoke</span><span class="hljs-params">(Component &amp; c)</span></span>{
    <span class="hljs-comment">//...</span>
    c.process();
    <span class="hljs-comment">//...</span>
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{

    <span class="hljs-function">Composite <span class="hljs-title">root</span><span class="hljs-params">(<span class="hljs-string">&quot;root&quot;</span>)</span></span>;
    <span class="hljs-function">Composite <span class="hljs-title">treeNode1</span><span class="hljs-params">(<span class="hljs-string">&quot;treeNode1&quot;</span>)</span></span>;
    <span class="hljs-function">Composite <span class="hljs-title">treeNode2</span><span class="hljs-params">(<span class="hljs-string">&quot;treeNode2&quot;</span>)</span></span>;
    <span class="hljs-function">Composite <span class="hljs-title">treeNode3</span><span class="hljs-params">(<span class="hljs-string">&quot;treeNode3&quot;</span>)</span></span>;
    <span class="hljs-function">Composite <span class="hljs-title">treeNode4</span><span class="hljs-params">(<span class="hljs-string">&quot;treeNode4&quot;</span>)</span></span>;
    <span class="hljs-function">Leaf <span class="hljs-title">leaf1</span><span class="hljs-params">(<span class="hljs-string">&quot;left1&quot;</span>)</span></span>;
    <span class="hljs-function">Leaf <span class="hljs-title">leaf2</span><span class="hljs-params">(<span class="hljs-string">&quot;left2&quot;</span>)</span></span>;
    <span class="hljs-function">Leaf <span class="hljs-title">leaf3</span><span class="hljs-params">(<span class="hljs-string">&quot;left3&quot;</span>)</span></span>;

    root.add(&amp;treeNode1);
    treeNode1.add(&amp;treeNode2);
    treeNode2.add(&amp;leaf1);

    root.add(&amp;treeNode3);
    treeNode3.add(&amp;treeNode4);
    treeNode4.add(&amp;leaf2);
    treeNode4.add(&amp;leaf3);

    <span class="hljs-comment">// root -----treeNode1---treeNode2---leaf1</span>
    <span class="hljs-comment">//      |</span>
    <span class="hljs-comment">//      | ---treeNode3---treeNode4---leaf2</span>
    <span class="hljs-comment">//                             |</span>
    <span class="hljs-comment">//                             |-----leaf3</span>
    Invoke(root);
    Invoke(leaf2);
    Invoke(treeNode3);

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x4EAB;&#x5143;&#x6A21;&#x5F0F;">&#x4EAB;&#x5143;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// flyweight.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; map&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">// &#x4EAB;&#x5143;&#x6A21;&#x5F0F;&#xFF08;&#x8F7B;&#x91CF;&#x6A21;&#x5F0F;&#xFF0C;&#x8F7B;&#x91CF;&#x7EA7;&#x7EC6;&#x7C92;&#x5EA6;&#x5BF9;&#x8C61;&#xFF09;&#x51CF;&#x5C11;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x7684;&#x6570;&#x91CF;,&#x4EE5;&#x51CF;&#x5C11;&#x5185;&#x5B58;&#x5360;&#x7528;&#x548C;&#x63D0;&#x9AD8;&#x6027;&#x80FD;&#x3002;</span>
<span class="hljs-comment">// &#x4E00;&#x7BC7;&#x6587;&#x6863;&#x4E2D;&#x5982;&#x679C;&#x6240;&#x6709;&#x6C49;&#x5B57;&#x90FD;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;&#x5B57;&#x4F53;&#x5BF9;&#x8C61;&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x7BC7;&#x6587;&#x6863;&#x6240;&#x8981;&#x5BB9;&#x7EB3;&#x7684;&#x5BF9;&#x8C61;&#x5C06;&#x662F;&#x975E;&#x5E38;&#x5E9E;&#x5927;&#x4E14;&#x8017;&#x8D39;&#x5185;&#x5B58;&#x7684;&#xFF0C;</span>
<span class="hljs-comment">// &#x5B9E;&#x9645;&#x7EC4;&#x6210;&#x6587;&#x6863;&#x7684;&#x5B57;&#x4F53;&#x662F;&#x6709;&#x9650;&#x7684;&#xFF0C;&#x6587;&#x6863;&#x662F;&#x7531;&#x8FD9;&#x4E9B;&#x5B57;&#x4F53;&#x7684;&#x6392;&#x5217;&#x7EC4;&#x5408;&#x5F97;&#x5230;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5C06;&#x6709;&#x9650;&#x7684;&#x5B57;&#x4F53;&#x96C6;&#x5171;&#x4EAB;&#x3002;</span>

<span class="hljs-keyword">class</span> Font {
<span class="hljs-keyword">private</span>:

    <span class="hljs-comment">//unique object key</span>
    <span class="hljs-built_in">string</span> key;

    <span class="hljs-comment">//object state</span>
    <span class="hljs-comment">//....</span>

<span class="hljs-keyword">public</span>:
    Font(<span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span>&amp; key){
        <span class="hljs-comment">//...</span>
    }
};

<span class="hljs-keyword">class</span> FontFactory{
<span class="hljs-keyword">private</span>:
    <span class="hljs-built_in">map</span>&lt;<span class="hljs-built_in">string</span>,Font* &gt; fontPool;

<span class="hljs-keyword">public</span>:
    <span class="hljs-function">Font* <span class="hljs-title">GetFont</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span>&amp; key)</span></span>{

        <span class="hljs-built_in">map</span>&lt;<span class="hljs-built_in">string</span>,Font*&gt;::iterator it = fontPool.find(key);

        <span class="hljs-keyword">if</span>(it != fontPool.end()){
            <span class="hljs-keyword">return</span> fontPool[key];
        }
        <span class="hljs-keyword">else</span>{
            Font* font = <span class="hljs-keyword">new</span> Font(key);
            fontPool[key]= font;
            <span class="hljs-keyword">return</span> font;
        }

    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//...</span>
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x884C;&#x4E3A;&#x578B;&#x6A21;&#x5F0F;&#xFF08;11&#x79CD;&#xFF09;">&#x884C;&#x4E3A;&#x578B;&#x6A21;&#x5F0F;&#xFF08;11&#x79CD;&#xFF09;</h2>
<p>&#x200B;   &#x7C7B;&#x548C;&#x5BF9;&#x8C61;&#x5982;&#x4F55;&#x4EA4;&#x4E92;&#xFF0C;&#x53CA;&#x5212;&#x5206;&#x8D23;&#x4EFB;&#x548C;&#x7B97;&#x6CD5;&#x3002;</p>
<h3 id="&#x7B56;&#x7565;&#x6A21;&#x5F0F;">&#x7B56;&#x7565;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// strategy1.cpp</span>
<span class="hljs-keyword">enum</span> TaxBase {
    CN_Tax,
    US_Tax,
    DE_Tax,
    FR_Tax       <span class="hljs-comment">//&#x66F4;&#x6539;</span>
};

<span class="hljs-keyword">class</span> SalesOrder{
    TaxBase tax;
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">CalculateTax</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//...</span>

        <span class="hljs-keyword">if</span> (tax == CN_Tax){
            <span class="hljs-comment">//CN***********</span>
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tax == US_Tax){
            <span class="hljs-comment">//US***********</span>
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tax == DE_Tax){
            <span class="hljs-comment">//DE***********</span>
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tax == FR_Tax){  <span class="hljs-comment">//&#x66F4;&#x6539;</span>
            <span class="hljs-comment">//...</span>
        }
        <span class="hljs-comment">//....</span>
     }
};
</code></pre>
<pre><code class="lang-c++"><span class="hljs-comment">// strategy2.cpp</span>
<span class="hljs-keyword">class</span> TaxStrategy{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">double</span> <span class="hljs-title">Calculate</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Context&amp; context)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">virtual</span> ~TaxStrategy(){}
};

<span class="hljs-keyword">class</span> CNTax : <span class="hljs-keyword">public</span> TaxStrategy{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">double</span> <span class="hljs-title">Calculate</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Context&amp; context)</span></span>{
        <span class="hljs-comment">//***********</span>
    }
};

<span class="hljs-keyword">class</span> USTax : <span class="hljs-keyword">public</span> TaxStrategy{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">double</span> <span class="hljs-title">Calculate</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Context&amp; context)</span></span>{
        <span class="hljs-comment">//***********</span>
    }
};

<span class="hljs-keyword">class</span> DETax : <span class="hljs-keyword">public</span> TaxStrategy{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">double</span> <span class="hljs-title">Calculate</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Context&amp; context)</span></span>{
        <span class="hljs-comment">//***********</span>
    }
};

<span class="hljs-comment">//&#x6269;&#x5C55;</span>
<span class="hljs-comment">//*********************************</span>
<span class="hljs-keyword">class</span> FRTax : <span class="hljs-keyword">public</span> TaxStrategy{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">double</span> <span class="hljs-title">Calculate</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Context&amp; context)</span></span>{
        <span class="hljs-comment">//.........</span>
    }
};

<span class="hljs-keyword">class</span> SalesOrder{
<span class="hljs-keyword">private</span>:
    TaxStrategy* strategy;

<span class="hljs-keyword">public</span>:
    SalesOrder(StrategyFactory* strategyFactory){
        <span class="hljs-keyword">this</span>-&gt;strategy = strategyFactory-&gt;NewStrategy();
    }
    ~SalesOrder(){
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>-&gt;strategy;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">CalculateTax</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//...</span>
        <span class="hljs-function">Context <span class="hljs-title">context</span><span class="hljs-params">()</span></span>;

        <span class="hljs-keyword">double</span> val =
            strategy-&gt;Calculate(context); <span class="hljs-comment">//&#x591A;&#x6001;&#x8C03;&#x7528;</span>
        <span class="hljs-comment">//...</span>
    }

};
</code></pre>
<h3 id="&#x6A21;&#x677F;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;">&#x6A21;&#x677F;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// template1_app.cpp</span>
<span class="hljs-comment">//&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;&#x4EBA;&#x5458;</span>
<span class="hljs-keyword">class</span> Application{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Step2</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//...</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Step4</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//...</span>
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-function">Library <span class="hljs-title">lib</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function">Application <span class="hljs-title">app</span><span class="hljs-params">()</span></span>;

    lib.Step1();

    <span class="hljs-keyword">if</span> (app.Step2()){
        lib.Step3();
    }

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++){
        app.Step4();
    }

    lib.Step5();

}
</code></pre>
<pre><code class="lang-c++"><span class="hljs-comment">// template1_lib.cpp</span>
<span class="hljs-comment">//&#x7A0B;&#x5E8F;&#x5E93;&#x5F00;&#x53D1;&#x4EBA;&#x5458;</span>
<span class="hljs-keyword">class</span> Library{

<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Step1</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//...</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Step3</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//...</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Step5</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//...</span>
    }
};
</code></pre>
<pre><code class="lang-c++"><span class="hljs-comment">// template2_app.cpp</span>
<span class="hljs-comment">//&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;&#x4EBA;&#x5458;</span>
<span class="hljs-keyword">class</span> Application : <span class="hljs-keyword">public</span> Library {
<span class="hljs-keyword">protected</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">Step2</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//... &#x5B50;&#x7C7B;&#x91CD;&#x5199;&#x5B9E;&#x73B0;</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Step4</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">//... &#x5B50;&#x7C7B;&#x91CD;&#x5199;&#x5B9E;&#x73B0;</span>
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
    </span>{
        Library* pLib=<span class="hljs-keyword">new</span> Application();
        lib-&gt;Run();

        <span class="hljs-keyword">delete</span> pLib;
    }
}
</code></pre>
<pre><code class="lang-c++"><span class="hljs-comment">// template2_lib.cpp</span>
<span class="hljs-comment">//&#x7A0B;&#x5E8F;&#x5E93;&#x5F00;&#x53D1;&#x4EBA;&#x5458;</span>
<span class="hljs-keyword">class</span> Library{
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">//&#x7A33;&#x5B9A; template method</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Run</span><span class="hljs-params">()</span></span>{

        Step1();

        <span class="hljs-keyword">if</span> (Step2()) { <span class="hljs-comment">//&#x652F;&#x6301;&#x53D8;&#x5316; ==&gt; &#x865A;&#x51FD;&#x6570;&#x7684;&#x591A;&#x6001;&#x8C03;&#x7528;</span>
            Step3();
        }

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++){
            Step4(); <span class="hljs-comment">//&#x652F;&#x6301;&#x53D8;&#x5316; ==&gt; &#x865A;&#x51FD;&#x6570;&#x7684;&#x591A;&#x6001;&#x8C03;&#x7528;</span>
        }

        Step5();

    }
    <span class="hljs-keyword">virtual</span> ~Library(){ }

<span class="hljs-keyword">protected</span>:

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Step1</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">//&#x7A33;&#x5B9A;</span>
        <span class="hljs-comment">//.....</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Step3</span><span class="hljs-params">()</span> </span>{<span class="hljs-comment">//&#x7A33;&#x5B9A;</span>
        <span class="hljs-comment">//.....</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Step5</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">//&#x7A33;&#x5B9A;</span>
        <span class="hljs-comment">//.....</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">Step2</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<span class="hljs-comment">//&#x53D8;&#x5316;</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Step4</span><span class="hljs-params">()</span> </span>=<span class="hljs-number">0</span>; <span class="hljs-comment">//&#x53D8;&#x5316;</span>
};
</code></pre>
<h3 id="&#x89C2;&#x5BDF;&#x8005;&#x6A21;&#x5F0F;">&#x89C2;&#x5BDF;&#x8005;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// Observer1-observer1.cpp</span>
<span class="hljs-comment">// &#x89C2;&#x5BDF;&#x8005;&#x6A21;&#x5F0F;&#xFF1A;&#x89C2;&#x5BDF;&#x8005;&#x6A21;&#x5F0F;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x79CD;&#x4E00;&#x961F;&#x591A;&#x7684;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#xFF0C;&#x8BA9;&#x591A;&#x4E2A;&#x89C2;&#x5BDF;&#x8005;&#x5BF9;&#x8C61;&#x540C;&#x65F6;&#x76D1;&#x542C;&#x67D0;&#x4E00;&#x4E2A;&#x4E3B;&#x9898;&#x5BF9;&#x8C61;&#x3002;</span>
<span class="hljs-comment">// &#x8FD9;&#x4E2A;&#x4E3B;&#x9898;&#x5BF9;&#x8C61;&#x5728;&#x72B6;&#x6001;&#x4E0A;&#x53D1;&#x751F; &#x53D8;&#x5316;&#x65F6;&#xFF0C;&#x4F1A;&#x901A;&#x77E5;&#x6240;&#x6709;&#x89C2;&#x5BDF;&#x8005;&#x5BF9;&#x8C61;&#xFF0C;&#x4F7F;&#x4ED6;&#x4EEC;&#x80FD;&#x591F;&#x81EA;&#x52A8;&#x66F4;&#x65B0;&#x81EA;&#x5DF1;&#x3002;</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; list&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">// &#x62BD;&#x8C61;&#x63A5;&#x53E3;&#xFF08;&#x8FDB;&#x5EA6;&#x6761;&#xFF09;</span>
<span class="hljs-keyword">class</span> IProgress {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoProgress</span><span class="hljs-params">(<span class="hljs-keyword">float</span> value)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">virtual</span> ~IProgress(){}
};

<span class="hljs-comment">// &#x6587;&#x4EF6;&#x5206;&#x5272;&#x5668;&#xFF0C;&#x6587;&#x4EF6;&#x5206;&#x9694;&#x5B8C;&#x6BD5;&#x540E;&#x901A;&#x77E5;&#x6240;&#x6709;&#x8FDB;&#x5EA6;&#x6761;&#x66F4;&#x65B0;&#x5176;&#x72B6;&#x6001;</span>
<span class="hljs-keyword">class</span> FileSplitter
{
    <span class="hljs-built_in">string</span> m_filePath;
    <span class="hljs-keyword">int</span> m_fileNumber;

    <span class="hljs-built_in">list</span>&lt;IProgress*&gt;  m_iprogressList; <span class="hljs-comment">// &#x62BD;&#x8C61;&#x901A;&#x77E5;&#x673A;&#x5236;&#xFF0C;&#x652F;&#x6301;&#x591A;&#x4E2A;&#x89C2;&#x5BDF;&#x8005;</span>

<span class="hljs-keyword">public</span>:
    FileSplitter(<span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span>&amp; filePath, <span class="hljs-keyword">int</span> fileNumber) :
        m_filePath(filePath),
        m_fileNumber(fileNumber){

    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">()</span></span>{

        <span class="hljs-comment">//1.&#x8BFB;&#x53D6;&#x5927;&#x6587;&#x4EF6;</span>

        <span class="hljs-comment">//2.&#x5206;&#x6279;&#x6B21;&#x5411;&#x5C0F;&#x6587;&#x4EF6;&#x4E2D;&#x5199;&#x5165;</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m_fileNumber; i++){
            <span class="hljs-comment">//...</span>

            <span class="hljs-keyword">float</span> progressValue = m_fileNumber;
            progressValue = (i + <span class="hljs-number">1</span>) / progressValue;
            onProgress(progressValue);<span class="hljs-comment">//&#x53D1;&#x9001;&#x901A;&#x77E5;</span>
        }

    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addIProgress</span><span class="hljs-params">(IProgress* iprogress)</span></span>{
        m_iprogressList.push_back(iprogress);
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">removeIProgress</span><span class="hljs-params">(IProgress* iprogress)</span></span>{
        m_iprogressList.remove(iprogress);
    }

<span class="hljs-keyword">protected</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onProgress</span><span class="hljs-params">(<span class="hljs-keyword">float</span> value)</span></span>{

        <span class="hljs-built_in">list</span>&lt;IProgress*&gt;::iterator itor=m_iprogressList.begin();

        <span class="hljs-keyword">while</span> (itor != m_iprogressList.end() ) {
            (*itor)-&gt;DoProgress(value); <span class="hljs-comment">//&#x66F4;&#x65B0;&#x8FDB;&#x5EA6;&#x6761;</span>
            itor++;
        }
    }
};
</code></pre>
<pre><code class="lang-c++"><span class="hljs-comment">// Observer1-mainform.cpp</span>
<span class="hljs-keyword">class</span> MainForm : <span class="hljs-keyword">public</span> IProgress
{
    TextBox* txtFilePath;
    TextBox* txtFileNumber;

    ProgressBar* progressBar;

<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Button1_Click</span><span class="hljs-params">()</span></span>{

        <span class="hljs-built_in">string</span> filePath = txtFilePath-&gt;getText();
        <span class="hljs-keyword">int</span> number = atoi(txtFileNumber-&gt;getText().c_str());

        ConsoleNotifier cn;

        <span class="hljs-function">FileSplitter <span class="hljs-title">splitter</span><span class="hljs-params">(filePath, number)</span></span>;

        splitter.addIProgress(<span class="hljs-keyword">this</span>); <span class="hljs-comment">//&#x8BA2;&#x9605;&#x901A;&#x77E5;</span>
        splitter.addIProgress(&amp;cn)&#xFF1B; <span class="hljs-comment">//&#x8BA2;&#x9605;&#x901A;&#x77E5;</span>

        splitter.split();

        splitter.removeIProgress(<span class="hljs-keyword">this</span>);

    }

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoProgress</span><span class="hljs-params">(<span class="hljs-keyword">float</span> value)</span></span>{
        progressBar-&gt;setValue(value);
    }
};

<span class="hljs-keyword">class</span> ConsoleNotifier : <span class="hljs-keyword">public</span> IProgress {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoProgress</span><span class="hljs-params">(<span class="hljs-keyword">float</span> value)</span></span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;.&quot;</span>;
    }
};
</code></pre>
<ul>
<li><p>c&#x8BED;&#x8A00;&#x7528;&#x51FD;&#x6570;&#x6307;&#x9488;&#x5B9E;&#x73B0;&#x89C2;&#x5BDF;&#x8005;&#x6A21;&#x5F0F;</p>
<p>   &#x73B0;&#x5728;&#x5047;&#x8BBE;&#x6709;&#x4E00;&#x7EC4;&#x539F;&#x59CB;&#x6570;&#x636E;&#xFF0C;&#x4F1A;&#x6709;&#x6298;&#x73B0;&#x56FE;&#x3001;sheet&#x8868;&#x4EE5;&#x53CA;&#x6BD4;&#x4F8B;&#x56FE;&#x7B49;&#x4E09;&#x79CD;&#x8868;&#x73B0;&#x5F62;&#x5F0F;&#xFF0C;
   &#x89C2;&#x5BDF;&#x8005;&#x6A21;&#x578B;&#x7684;&#x601D;&#x60F3;&#x5C31;&#x662F;&#x5728;&#x539F;&#x59CB;&#x6570;&#x636E;&#x6709;&#x53D8;&#x5316;&#x540E;&#x53D1;&#x5E03;&#x4E00;&#x6761;&#x901A;&#x77E5;&#xFF0C;&#x4E09;&#x79CD;&#x8868;&#x73B0;&#x5F62;&#x5F0F;&#x4F1A;&#x540C;&#x6B65;&#x66F4;&#x65B0;&#x663E;&#x793A;&#xFF0C;
   &#x539F;&#x59CB;&#x6570;&#x636E;&#x5C31;&#x662F;Subject&#xFF0C;&#x4E09;&#x79CD;&#x8868;&#x73B0;&#x5F62;&#x5F0F;&#x5C31;&#x662F;Observer&#xFF0C;&#x4E0B;&#x9762;&#x4F7F;&#x7528;C&#x8BED;&#x8A00;&#x5B9E;&#x73B0;&#x8BE5;&#x6A21;&#x578B;&#x3002;</p>
</li>
</ul>
<pre><code class="lang-c++">     <span class="hljs-comment">// Observer2-Subject.h</span>
     <span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> SRC_SUBJECT_H_</span>
     <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SRC_SUBJECT_H_</span>

     <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-string">&quot;List.h&quot;</span></span>
     <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-string">&quot;Observer.h&quot;</span></span>

     <span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> _Subject Subject;
     <span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> _Subject* SubjectPtr;
     <span class="hljs-keyword">struct</span> _Subject
    {
        <span class="hljs-keyword">int</span> val;
        <span class="hljs-keyword">struct</span> list_head <span class="hljs-built_in">list</span>;
        <span class="hljs-keyword">void</span> (*add)(SubjectPtr sp, ObserverPtr op);
        <span class="hljs-keyword">void</span> (*remove)(SubjectPtr sp, ObserverPtr op);
        <span class="hljs-keyword">void</span> (*notify)(SubjectPtr sp);
        <span class="hljs-keyword">void</span> (*changeEvent)(SubjectPtr sp, <span class="hljs-keyword">int</span> code);
    };

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Subject_Init</span><span class="hljs-params">(SubjectPtr sp)</span></span>;

    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* SRC_SUBJECT_H_ */</span></span>
</code></pre>
<pre><code> &#x200B;

 ```c++
 // Observer2- Subject.c
 #include &quot;Subject.h&quot;

static void Subject_AddObserver(SubjectPtr sp, ObserverPtr op)
{
    list_add_tail(&amp;op-&gt;node, &amp;sp-&gt;list);
}

static void Subject_RemoveObserver(SubjectPtr sp, ObserverPtr op)
{
    list_del(&amp;op-&gt;node);
}

 static void Subject_NotifyObserver(SubjectPtr sp)
 {
    ObserverPtr op;
    list_for_each_entry(op, &amp;sp-&gt;list, node)
    {
        op-&gt;update(sp-&gt;val);
    }
 }

 static void Subject_ChangeEvent(SubjectPtr sp, int code)
 {
    sp-&gt;val = code;
 }

 void Subject_Init(SubjectPtr sp)
 {
    sp-&gt;add = Subject_AddObserver;
    sp-&gt;remove = Subject_RemoveObserver;
    sp-&gt;notify = Subject_NotifyObserver;
    sp-&gt;changeEvent = Subject_ChangeEvent;
    sp-&gt;val = 0;
    INIT_LIST_HEAD(&amp;sp-&gt;list);
 }
 ```
 &#x200B;

```c
/*
* Observer.h
*
*  Created on: 2019&#x5E74;5&#x6708;15&#x65E5;
*      Author: Administrator
*/

#ifndef SRC_OBSERVER_H_
#define SRC_OBSERVER_H_

#include &lt;stdlib.h&gt;
#include &quot;List.h&quot;

typedef void(*update_fun_ptr)(int val);

typedef struct
{
    update_fun_ptr update;
    struct list_head node;
}Observer, *ObserverPtr;

typedef struct
{
    Observer obs;
    /*
    * &#x4EE5;&#x4E0B;&#x662F;&#x672C;&#x7C7B;&#x72EC;&#x6709;&#x6570;&#x636E;
    */
}SheetObserver, *SheetObserverPtr;

typedef struct
{
     Observer obs;
    /*
    * &#x4EE5;&#x4E0B;&#x662F;&#x672C;&#x7C7B;&#x72EC;&#x6709;&#x6570;&#x636E;
    */
}ChartObserver, *ChartObserverPtr;

typedef struct
{
    Observer obs;
    /*
     * &#x4EE5;&#x4E0B;&#x662F;&#x672C;&#x7C7B;&#x72EC;&#x6709;&#x6570;&#x636E;
     */
}ScaleObserver, *ScaleObserverPtr;

 void update_sheet(int val);
 void update_chart(int val);
 void update_scale(int val);
 void Observer_Init(ObserverPtr op, update_fun_ptr fptr);

 #endif /* SRC_OBSERVER_H_ */
 ```
 &#x200B;

 ```c
 // Observer2- Observer.c
 #include &quot;Observer.h&quot;

 void update_sheet(int val)
 {
    printf(&quot;%s: code = %d \r\n&quot;, __FUNCTION__, val);
 }

 void update_chart(int val)
 {
    printf(&quot;%s: code = %d \r\n&quot;, __FUNCTION__, val);
 }

 void update_scale(int val)
 {
    printf(&quot;%s: code = %d \r\n&quot;, __FUNCTION__, val);
 }

 void Observer_Init(ObserverPtr op, update_fun_ptr fptr)
 {
    op-&gt;update = fptr;
    op-&gt;node.next = NULL;
    op-&gt;node.prev = NULL;
 }
 ```
 &#x200B;

 ```c
 // Observer2- main.c
 #include &lt; stdio.h&gt;
 #include &quot;Observer.h&quot;
 #include &quot;Subject.h&quot;

 int main()
 {
    Subject sb;
    SheetObserver sheet;
    ScaleObserver scale;
    ChartObserver chart;

    Subject_Init(&amp;sb);
    Observer_Init(&amp;sheet.obs, update_sheet);
    Observer_Init(&amp;scale.obs, update_scale);
    Observer_Init(&amp;chart.obs, update_chart);

    sb.add(&amp;sb, &amp;sheet.obs);
    sb.add(&amp;sb, &amp;scale.obs);
    sb.add(&amp;sb, &amp;chart.obs);

    sb.changeEvent(&amp;sb, 4);
    sb.notify(&amp;sb);
    printf(&quot;\n\n&quot;);

    sb.remove(&amp;sb, &amp;scale.obs);
    sb.changeEvent(&amp;sb, 0xFF);
    sb.notify(&amp;sb);

     return 0;
 }
 ```
 &#x200B;
</code></pre><h3 id="&#x8FED;&#x4EE3;&#x5B50;&#x6A21;&#x5F0F;">&#x8FED;&#x4EE3;&#x5B50;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// iterator.cpp</span>
<span class="hljs-comment">// &#x8FED;&#x4EE3;&#x5668;&#x6A21;&#x5F0F;&#xFF1A;&#x63D0;&#x4F9B;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x987A;&#x5E8F;&#x8BBF;&#x95EE;&#x4E00;&#x4E2A;&#x805A;&#x5408;&#x5BF9;&#x8C61;&#x4E2D;&#x5404;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x800C;&#x53C8;&#x4E0D;&#x9700;&#x8981;&#x66B4;&#x9732;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x5185;&#x90E8;&#x8868;&#x793A;&#x3002;</span>
<span class="hljs-comment">// &#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x4E2D;&#x7684;&#x8FED;&#x4EE3;&#x5668;&#x6A21;&#x5F0F;&#x6709;&#x70B9;&#x8FC7;&#x65F6;&#x4E86;&#xFF0C;&#x53EF;&#x4EE5;&#x88AB;stl&#x4E2D;&#x7684;&#x8FED;&#x4EE3;&#x5668;&#x53D6;&#x4EE3;</span>
<span class="hljs-comment">// stl&#x4E2D;&#x6CDB;&#x578B;&#x7F16;&#x7A0B;&#xFF08;&#x6A21;&#x677F;&#x7C7B; &#x7F16;&#x8BD1;&#x65F6;&#x7ED1;&#x5B9A;&#x7684;&#x65B9;&#x6848;&#xFF09;&#x6548;&#x7387;&#x66F4;&#x9AD8;</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-keyword">template</span>&lt; <span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">class</span> Iterator
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">first</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">next</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">isDone</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> T&amp; <span class="hljs-title">current</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
};

<span class="hljs-keyword">template</span>&lt; <span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">class</span> MyCollection{

<span class="hljs-keyword">public</span>:

    Iterator&lt; T&gt; *GetIterator(){
        <span class="hljs-comment">//...</span>
    }

};

<span class="hljs-keyword">template</span>&lt; <span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">class</span> CollectionIterator : <span class="hljs-keyword">public</span> Iterator&lt; T&gt;{
    MyCollection&lt; T&gt; mc;
<span class="hljs-keyword">public</span>:

    CollectionIterator(<span class="hljs-keyword">const</span> MyCollection&lt; T&gt; &amp; c): mc(c){ }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">first</span><span class="hljs-params">()</span>  </span>{

    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">next</span><span class="hljs-params">()</span>  </span>{

    }
    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">isDone</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{

    }
    <span class="hljs-function">T&amp; <span class="hljs-title">current</span><span class="hljs-params">()</span> </span>{

    }
};

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">MyAlgorithm</span><span class="hljs-params">()</span>
</span>{
    MyCollection&lt; <span class="hljs-keyword">int</span>&gt; mc;

    Iterator&lt; <span class="hljs-keyword">int</span>&gt; *iter = mc.GetIterator();

    <span class="hljs-keyword">for</span> (iter-&gt;first(); !iter-&gt;isDone(); iter-&gt;next()){
        <span class="hljs-built_in">cout</span> &lt;&lt; iter-&gt;current() &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    MyAlgorithm();
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x8D23;&#x4EFB;&#x94FE;&#x6A21;&#x5F0F;">&#x8D23;&#x4EFB;&#x94FE;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// chainonresponsibility.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; string&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-keyword">namespace</span> DataDefine {
<span class="hljs-keyword">enum</span> RequestType
{
    REQ_HANDLER1,
    REQ_HANDLER2,
    REQ_HANDLER3
};
};

<span class="hljs-keyword">class</span> Reqest
{
    <span class="hljs-built_in">string</span> description;
    DataDefine::RequestType reqType;
<span class="hljs-keyword">public</span>:
    Reqest(<span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> &amp;desc, DataDefine::RequestType type) : description(desc), reqType(type) {}
    DataDefine::<span class="hljs-function">RequestType <span class="hljs-title">getReqType</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> reqType; }
    <span class="hljs-function"><span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span>&amp; <span class="hljs-title">getDescription</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> description; }
};

<span class="hljs-keyword">class</span> ChainHandler{
<span class="hljs-keyword">private</span>:
    ChainHandler *nextChain;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sendReqestToNextHandler</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Reqest &amp; req)</span>
    </span>{
        <span class="hljs-keyword">if</span> (nextChain != <span class="hljs-literal">NULL</span>)
            nextChain-&gt;handle(req);
    }

<span class="hljs-keyword">public</span>:
    ChainHandler() { nextChain = <span class="hljs-literal">NULL</span>; }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setNextChain</span><span class="hljs-params">(ChainHandler *next)</span> </span>{ nextChain = next; }

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">canHandleRequest</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Reqest &amp; req)</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processRequest</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Reqest &amp; req)</span> </span>= <span class="hljs-number">0</span>;

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">handle</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Reqest &amp; req)</span>
    </span>{
        <span class="hljs-keyword">if</span> (canHandleRequest(req))
            processRequest(req);
        <span class="hljs-keyword">else</span>
            sendReqestToNextHandler(req);
    }
};

<span class="hljs-keyword">class</span> Handler1 : <span class="hljs-keyword">public</span> ChainHandler{
<span class="hljs-keyword">protected</span>:
    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">canHandleRequest</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Reqest &amp; req)</span>
    </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Handler1 canHandleRequest...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> req.getReqType() == DataDefine::REQ_HANDLER1;
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">processRequest</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Reqest &amp; req)</span>
    </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Handler1 is handle reqest: &quot;</span> &lt;&lt; req.getDescription() &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-keyword">class</span> Handler2 : <span class="hljs-keyword">public</span> ChainHandler{
<span class="hljs-keyword">protected</span>:
    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">canHandleRequest</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Reqest &amp; req)</span>
    </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Handler2 canHandleRequest...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> req.getReqType() == DataDefine::REQ_HANDLER2;
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">processRequest</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Reqest &amp; req)</span>
    </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Handler2 is handle reqest: &quot;</span> &lt;&lt; req.getDescription() &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-keyword">class</span> Handler3 : <span class="hljs-keyword">public</span> ChainHandler{
<span class="hljs-keyword">protected</span>:
    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">canHandleRequest</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Reqest &amp; req)</span>
    </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Handler3 canHandleRequest...&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> req.getReqType() == DataDefine::REQ_HANDLER3;
    }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">processRequest</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Reqest &amp; req)</span>
    </span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Handler3 is handle reqest: &quot;</span> &lt;&lt; req.getDescription() &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    Handler1 h1;
    Handler2 h2;
    Handler3 h3;
    h1.setNextChain(&amp;h2);
    h2.setNextChain(&amp;h3);

    <span class="hljs-function">Reqest <span class="hljs-title">req</span><span class="hljs-params">(<span class="hljs-string">&quot;process task ... &quot;</span>, DataDefine::REQ_HANDLER3)</span></span>;
    h1.handle(req);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x547D;&#x4EE4;&#x6A21;&#x5F0F;">&#x547D;&#x4EE4;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// command.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; string&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">// &#x5C06;&#x51FD;&#x6570;&#x5C01;&#x88C5;&#x4E3A;&#x5BF9;&#x8C61;&#xFF0C;&#x5C31;&#x80FD;&#x591F;&#x4EE5;&#x53C2;&#x6570;&#x7684;&#x5F62;&#x5F0F;&#x5C06;&#x5176;&#x4F20;&#x9012;&#x7ED9;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#x6216;&#x8005;&#x5BF9;&#x8C61;&#xFF0C;&#x544A;&#x8BC9;&#x5B83;&#x4EEC;&#x5728;&#x65C5;&#x884C;&#x8BF7;&#x6C42;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x6267;&#x884C;&#x7279;&#x5B9A;&#x7684;&#x64CD;&#x4F5C;&#x3002;</span>
<span class="hljs-comment">// &#x53EF;&#x4EE5;&#x7528;c++&#x51FD;&#x6570;&#x5BF9;&#x8C61;&#xFF08;&#x91CD;&#x8F7D;()&#x8FD0;&#x7B97;&#x7B26;&#xFF09;&#x66FF;&#x4EE3;</span>

<span class="hljs-keyword">class</span> Command
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
};

<span class="hljs-keyword">class</span> ConcreteCommand1 : <span class="hljs-keyword">public</span> Command
{
    <span class="hljs-built_in">string</span> arg;
<span class="hljs-keyword">public</span>:
    ConcreteCommand1(<span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> &amp; a) : arg(a) {}
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-built_in">cout</span>&lt;&lt; <span class="hljs-string">&quot;#1 process...&quot;</span>&lt;&lt;arg&lt;&lt;<span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-keyword">class</span> ConcreteCommand2 : <span class="hljs-keyword">public</span> Command
{
    <span class="hljs-built_in">string</span> arg;
<span class="hljs-keyword">public</span>:
    ConcreteCommand2(<span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> &amp; a) : arg(a) {}
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-built_in">cout</span>&lt;&lt; <span class="hljs-string">&quot;#2 process...&quot;</span>&lt;&lt;arg&lt;&lt;<span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-keyword">class</span> MacroCommand : <span class="hljs-keyword">public</span> Command
{
    <span class="hljs-built_in">vector</span>&lt; Command*&gt; commands;
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addCommand</span><span class="hljs-params">(Command *c)</span> </span>{ commands.push_back(c); }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-built_in">vector</span>&lt; Command*&gt;::iterator it = commands.begin();
        <span class="hljs-keyword">for</span> (;it != commands.end(); it++)
        {
            (*it)-&gt;execute();
        }
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{

    <span class="hljs-function">ConcreteCommand1 <span class="hljs-title">command1</span><span class="hljs-params">(<span class="hljs-string">&quot;Arg ###&quot;</span>)</span></span>;
    <span class="hljs-function">ConcreteCommand2 <span class="hljs-title">command2</span><span class="hljs-params">(<span class="hljs-string">&quot;Arg $$$&quot;</span>)</span></span>;

    MacroCommand macro;
    macro.addCommand(&amp;command1);
    macro.addCommand(&amp;command2);

    macro.execute();

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x5907;&#x5FD8;&#x5F55;&#x6A21;&#x5F0F;">&#x5907;&#x5FD8;&#x5F55;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// memento.cpp</span>
<span class="hljs-comment">// &#x5907;&#x5FD8;&#x5F55;&#x6A21;&#x5F0F;&#xFF1A;&#x5907;&#x5FD8;&#x5F55;&#x5BF9;&#x8C61;&#x662F;&#x4E00;&#x4E2A;&#x7528;&#x6765;&#x5B58;&#x50A8;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5185;&#x90E8;&#x72B6;&#x6001;&#x7684;&#x5FEB;&#x7167;&#x7684;&#x5BF9;&#x8C61;&#x3002;</span>
<span class="hljs-comment">// &#x5907;&#x5FD8;&#x5F55;&#x6A21;&#x5F0F;&#x7684;&#x7528;&#x610F;&#x662F;&#x5728;&#x4E0D;&#x7834;&#x574F;&#x5C01;&#x88C5;&#x7684;&#x6761;&#x4EF6;&#x4E0B;&#xFF0C;&#x5C06;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x72B6;&#x6001;&#x6349;&#x4F4F;&#xFF0C;&#x5E76;&#x5916;&#x90E8;&#x5316;&#xFF0C;&#x5B58;&#x50A8;&#x8D77;&#x6765;&#xFF0C;</span>
<span class="hljs-comment">// &#x4ECE;&#x800C;&#x53EF;&#x4EE5;&#x5728;&#x5C06;&#x6765;&#x5408;&#x9002;&#x7684;&#x65F6;&#x5019;&#x628A;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x8FD8;&#x539F;&#x5230;&#x5B58;&#x50A8;&#x8D77;&#x6765;&#x7684;&#x72B6;&#x6001;&#x3002;</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-keyword">class</span> Memento
{
    <span class="hljs-built_in">string</span> state;
    <span class="hljs-comment">//..</span>
<span class="hljs-keyword">public</span>:
    Memento(<span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> &amp; s) : state(s) {}
    <span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">getState</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> state; }
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setState</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> &amp; s)</span> </span>{ state = s; }
};

<span class="hljs-keyword">class</span> Originator
{
    <span class="hljs-built_in">string</span> state;
    <span class="hljs-comment">//....</span>
<span class="hljs-keyword">public</span>:
    Originator() {}

    <span class="hljs-function">Memento <span class="hljs-title">createMomento</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-function">Memento <span class="hljs-title">m</span><span class="hljs-params">(state)</span></span>;
        <span class="hljs-keyword">return</span> m;
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setMomento</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Memento &amp; m)</span> </span>{
        state = m.getState();
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    Originator orginator;

    <span class="hljs-comment">//&#x6355;&#x83B7;&#x5BF9;&#x8C61;&#x72B6;&#x6001;&#xFF0C;&#x5B58;&#x50A8;&#x5230;&#x5907;&#x5FD8;&#x5F55;</span>
    Memento mem = orginator.createMomento();

    <span class="hljs-comment">//... &#x6539;&#x53D8;orginator&#x72B6;&#x6001;</span>
    <span class="hljs-comment">//&#x4ECE;&#x5907;&#x5FD8;&#x5F55;&#x4E2D;&#x6062;&#x590D;</span>
    orginator.setMomento(mem);
}
</code></pre>
<h3 id="&#x72B6;&#x6001;&#x6A21;&#x5F0F;">&#x72B6;&#x6001;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// state.cpp</span>
<span class="hljs-keyword">class</span> NetworkState{

<span class="hljs-keyword">public</span>:
    NetworkState* pNext;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Operation1</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Operation2</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Operation3</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;

    <span class="hljs-keyword">virtual</span> ~NetworkState(){}
};

<span class="hljs-keyword">class</span> OpenState :<span class="hljs-keyword">public</span> NetworkState{

    <span class="hljs-keyword">static</span> NetworkState* m_instance;
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">static</span> NetworkState* <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">if</span> (m_instance == <span class="hljs-literal">nullptr</span>) {
            m_instance = <span class="hljs-keyword">new</span> OpenState();
        }
        <span class="hljs-keyword">return</span> m_instance;
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Operation1</span><span class="hljs-params">()</span></span>{

        <span class="hljs-comment">//**********</span>
        pNext = CloseState::getInstance();
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Operation2</span><span class="hljs-params">()</span></span>{

        <span class="hljs-comment">//..........</span>
        pNext = ConnectState::getInstance();
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Operation3</span><span class="hljs-params">()</span></span>{

        <span class="hljs-comment">//$$$$$$$$$$</span>
        pNext = OpenState::getInstance();
    }
};

<span class="hljs-keyword">class</span> CloseState:<span class="hljs-keyword">public</span> NetworkState{ }
<span class="hljs-comment">//...</span>

<span class="hljs-keyword">class</span> NetworkProcessor{

    NetworkState* pState;

<span class="hljs-keyword">public</span>:

    NetworkProcessor(NetworkState* pState){

        <span class="hljs-keyword">this</span>-&gt;pState = pState;
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Operation1</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//...</span>
        pState-&gt;Operation1();
        pState = pState-&gt;pNext;
        <span class="hljs-comment">//...</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Operation2</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//...</span>
        pState-&gt;Operation2();
        pState = pState-&gt;pNext;
        <span class="hljs-comment">//...</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Operation3</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//...</span>
        pState-&gt;Operation3();
        pState = pState-&gt;pNext;
        <span class="hljs-comment">//...</span>
    }

};
</code></pre>
<h3 id="&#x8BBF;&#x95EE;&#x8005;&#x6A21;&#x5F0F;">&#x8BBF;&#x95EE;&#x8005;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// Visitor1.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-keyword">class</span> Visitor;

<span class="hljs-keyword">class</span> Element
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(Visitor&amp; visitor)</span> </span>= <span class="hljs-number">0</span>; <span class="hljs-comment">//&#x7B2C;&#x4E00;&#x6B21;&#x591A;&#x6001;&#x8FA8;&#x6790;</span>

    <span class="hljs-keyword">virtual</span> ~Element(){}
};

<span class="hljs-keyword">class</span> ElementA : <span class="hljs-keyword">public</span> Element
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(Visitor &amp;visitor)</span> override </span>{
        visitor.visitElementA(*<span class="hljs-keyword">this</span>);
    }
};

<span class="hljs-keyword">class</span> ElementB : <span class="hljs-keyword">public</span> Element
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(Visitor &amp;visitor)</span> override </span>{
        visitor.visitElementB(*<span class="hljs-keyword">this</span>); <span class="hljs-comment">//&#x7B2C;&#x4E8C;&#x6B21;&#x591A;&#x6001;&#x8FA8;&#x6790;</span>
    }

};

<span class="hljs-keyword">class</span> Visitor{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">visitElementA</span><span class="hljs-params">(ElementA&amp; element)</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">visitElementB</span><span class="hljs-params">(ElementB&amp; element)</span> </span>= <span class="hljs-number">0</span>;

    <span class="hljs-keyword">virtual</span> ~Visitor(){}
};

<span class="hljs-comment">//=============&#x4E0A;&#x8FB9;&#x662F;&#x7A33;&#x5B9A;&#x7684;&#x90E8;&#x5206;=====================</span>

<span class="hljs-comment">//&#x6269;&#x5C55;1</span>
<span class="hljs-keyword">class</span> Visitor1 : <span class="hljs-keyword">public</span> Visitor{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">visitElementA</span><span class="hljs-params">(ElementA&amp; element)</span> override</span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Visitor1 is processing ElementA&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">visitElementB</span><span class="hljs-params">(ElementB&amp; element)</span> override</span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Visitor1 is processing ElementB&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-comment">//&#x6269;&#x5C55;2</span>
<span class="hljs-keyword">class</span> Visitor2 : <span class="hljs-keyword">public</span> Visitor{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">visitElementA</span><span class="hljs-params">(ElementA&amp; element)</span> override</span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Visitor2 is processing ElementA&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">visitElementB</span><span class="hljs-params">(ElementB&amp; element)</span> override</span>{
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Visitor2 is processing ElementB&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    Visitor2 visitor;
    ElementB elementB;
    elementB.accept(visitor);<span class="hljs-comment">// double dispatch</span>

    ElementA elementA;
    elementA.accept(visitor);

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<pre><code class="lang-c++"><span class="hljs-comment">// Visitor2.cpp</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-keyword">class</span> Visitor;

<span class="hljs-keyword">class</span> Element
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Func1</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Func2</span><span class="hljs-params">(<span class="hljs-keyword">int</span> data)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Func3</span><span class="hljs-params">(<span class="hljs-keyword">int</span> data)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-comment">//...</span>

    <span class="hljs-keyword">virtual</span> ~Element(){}
};

<span class="hljs-keyword">class</span> ElementA : <span class="hljs-keyword">public</span> Element
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Func1</span><span class="hljs-params">()</span> override</span>{
        <span class="hljs-comment">//...</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Func2</span><span class="hljs-params">(<span class="hljs-keyword">int</span> data)</span> override</span>{
        <span class="hljs-comment">//...</span>
    }
};

<span class="hljs-keyword">class</span> ElementB : <span class="hljs-keyword">public</span> Element
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Func1</span><span class="hljs-params">()</span> override</span>{
        <span class="hljs-comment">//***</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Func2</span><span class="hljs-params">(<span class="hljs-keyword">int</span> data)</span> override </span>{
        <span class="hljs-comment">//***</span>
    }

};
</code></pre>
<h3 id="&#x4E2D;&#x4ECB;&#x8005;&#x6A21;&#x5F0F;">&#x4E2D;&#x4ECB;&#x8005;&#x6A21;&#x5F0F;</h3>
<h3 id="&#x89E3;&#x91CA;&#x5668;&#x6A21;&#x5F0F;">&#x89E3;&#x91CA;&#x5668;&#x6A21;&#x5F0F;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">// interpreter.cpp</span>
<span class="hljs-comment">// &#x89E3;&#x51B3;&#x7684;&#x95EE;&#x9898;&#xFF1A;&#x5982;&#x679C;&#x4E00;&#x79CD;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x95EE;&#x9898;&#x53D1;&#x751F;&#x7684;&#x9891;&#x7387;&#x8DB3;&#x591F;&#x9AD8;&#xFF0C;&#x5C31;&#x53EF;&#x5C06;&#x8BE5;&#x95EE;&#x9898;&#x7684;&#x5404;&#x4E2A;&#x5B9E;&#x4F8B;&#x8868;&#x8FF0;&#x4E3A;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x8BED;&#x8A00;&#x4E2D;&#x7684;&#x53E5;&#x5B50;&#xFF0C;</span>
<span class="hljs-comment">//             &#x5982;&#x679C;&#x53EF;&#x5C06;&#x8BE5;&#x8BED;&#x8A00;&#x4E2D;&#x7684;&#x53E5;&#x5B50;&#x8868;&#x793A;&#x4E3A;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x8BED;&#x6CD5;&#x6811;&#x65F6;&#xFF0C;&#x5219;&#x53EF;&#x4F7F;&#x7528;&#x89E3;&#x91CA;&#x5668;&#x6A21;&#x5F0F;&#x3002;</span>
<span class="hljs-comment">//             &#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x89E3;&#x91CA;&#x5668;&#xFF0C;&#x8BE5;&#x89E3;&#x91CA;&#x5668;&#x901A;&#x8FC7;&#x89E3;&#x91CA;&#x8FD9;&#x4E9B;&#x53E5;&#x5B50;&#x6765;&#x89E3;&#x51B3;&#x8BE5;&#x95EE;&#x9898;&#x3002;</span>
<span class="hljs-comment">// &#x4E0D;&#x8DB3;&#xFF1A;&#x89E3;&#x91CA;&#x5668;&#x6A21;&#x5F0F;&#x4E3A;&#x6587;&#x6CD5;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x6761;&#x89C4;&#x5219;&#x81F3;&#x5C11;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x7C7B;&#xFF0C;&#x56E0;&#x6B64;&#x5305;&#x542B;&#x8BB8;&#x591A;&#x89C4;&#x5219;&#x7684;&#x6587;&#x6CD5;&#x53EF;&#x80FD;&#x96BE;&#x4EE5;&#x7BA1;&#x7406;&#x548C;&#x7EF4;&#x62A4;&#x3002;</span>
<span class="hljs-comment">//       &#x5EFA;&#x8BAE;&#x5F53;&#x6587;&#x6CD5;&#x975E;&#x5E38;&#x590D;&#x6742;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x5176;&#x4ED6;&#x7684;&#x6280;&#x672F;&#x5982;&#x8BED;&#x6CD5;&#x5206;&#x6790;&#x7A0B;&#x5E8F;&#x6216;&#x7F16;&#x8BD1;&#x5668;&#x751F;&#x6210;&#x5668;&#x6765;&#x5904;&#x7406;&#x3002;</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; map&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt; stack&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-comment">// &#x8868;&#x8FBE;&#x5F0F;&#x62BD;&#x8C61;&#x57FA;&#x7C7B;</span>
<span class="hljs-keyword">class</span> Expression {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">interpreter</span><span class="hljs-params">(<span class="hljs-built_in">map</span>&lt; <span class="hljs-keyword">char</span>, <span class="hljs-keyword">int</span>&gt; var)</span></span>=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">virtual</span> ~Expression(){}

};

<span class="hljs-comment">//&#x53D8;&#x91CF;&#x8868;&#x8FBE;&#x5F0F;</span>
<span class="hljs-keyword">class</span> VarExpression: <span class="hljs-keyword">public</span> Expression {

    <span class="hljs-keyword">char</span> key;

<span class="hljs-keyword">public</span>:
    VarExpression(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>&amp; key) {
        <span class="hljs-keyword">this</span>-&gt;key = key;
    }

    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">interpreter</span><span class="hljs-params">(<span class="hljs-built_in">map</span>&lt; <span class="hljs-keyword">char</span>, <span class="hljs-keyword">int</span>&gt; var)</span> </span>{
        <span class="hljs-keyword">return</span> var[key];
    }

};

<span class="hljs-comment">//&#x7B26;&#x53F7;&#x8868;&#x8FBE;&#x5F0F;</span>
<span class="hljs-keyword">class</span> SymbolExpression : <span class="hljs-keyword">public</span> Expression {

    <span class="hljs-comment">// &#x8FD0;&#x7B97;&#x7B26;&#x5DE6;&#x53F3;&#x4E24;&#x4E2A;&#x53C2;&#x6570;</span>
<span class="hljs-keyword">protected</span>:
    Expression* left;
    Expression* right;

<span class="hljs-keyword">public</span>:
    SymbolExpression( Expression* left,  Expression* right):
        left(left),right(right){
    }
};

<span class="hljs-comment">//&#x52A0;&#x6CD5;&#x8FD0;&#x7B97;</span>
<span class="hljs-keyword">class</span> AddExpression : <span class="hljs-keyword">public</span> SymbolExpression {

<span class="hljs-keyword">public</span>:
    AddExpression(Expression* left, Expression* right):
        SymbolExpression(left,right){

    }
    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">interpreter</span><span class="hljs-params">(<span class="hljs-built_in">map</span>&lt; <span class="hljs-keyword">char</span>, <span class="hljs-keyword">int</span>&gt; var)</span> </span>{
        <span class="hljs-keyword">return</span> left-&gt;interpreter(var) + right-&gt;interpreter(var);
    }
};

<span class="hljs-comment">//&#x51CF;&#x6CD5;&#x8FD0;&#x7B97;</span>
<span class="hljs-keyword">class</span> SubExpression : <span class="hljs-keyword">public</span> SymbolExpression {

<span class="hljs-keyword">public</span>:
    SubExpression(Expression* left, Expression* right):
        SymbolExpression(left,right){

    }
    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">interpreter</span><span class="hljs-params">(<span class="hljs-built_in">map</span>&lt; <span class="hljs-keyword">char</span>, <span class="hljs-keyword">int</span>&gt; var)</span> </span>{
        <span class="hljs-keyword">return</span> left-&gt;interpreter(var) - right-&gt;interpreter(var);
    }

};

<span class="hljs-comment">// &#x8BED;&#x6CD5;&#x5206;&#x6790;</span>
<span class="hljs-function">Expression*  <span class="hljs-title">analyse</span><span class="hljs-params">(<span class="hljs-built_in">string</span> expStr)</span> </span>{

    <span class="hljs-built_in">stack</span>&lt; Expression*&gt; expStack;
    Expression* left = <span class="hljs-literal">NULL</span>;
    Expression* right = <span class="hljs-literal">NULL</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i &lt; expStr.size(); i++)
    {
        <span class="hljs-keyword">switch</span>(expStr[i])
        {
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;+&apos;</span>:
                <span class="hljs-comment">// &#x52A0;&#x6CD5;&#x8FD0;&#x7B97;</span>
                left = expStack.top();
                right = <span class="hljs-keyword">new</span> VarExpression(expStr[++i]);
                expStack.push(<span class="hljs-keyword">new</span> AddExpression(left, right));
                <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;add=&quot;</span> &lt;&lt; expStr[i] &lt;&lt; <span class="hljs-built_in">endl</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;-&apos;</span>:
                <span class="hljs-comment">// &#x51CF;&#x6CD5;&#x8FD0;&#x7B97;</span>
                left = expStack.top();
                right = <span class="hljs-keyword">new</span> VarExpression(expStr[++i]);
                expStack.push(<span class="hljs-keyword">new</span> SubExpression(left, right));
                <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;sub=&quot;</span> &lt;&lt; expStr[i] &lt;&lt; <span class="hljs-built_in">endl</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">default</span>:
                <span class="hljs-comment">// &#x53D8;&#x91CF;&#x8868;&#x8FBE;&#x5F0F;</span>
                <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;var=&quot;</span> &lt;&lt; expStr[i] &lt;&lt; <span class="hljs-built_in">endl</span>;
                expStack.push(<span class="hljs-keyword">new</span> VarExpression(expStr[i]));
        }
    }

    Expression* expression = expStack.top();

    <span class="hljs-keyword">return</span> expression;
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">release</span><span class="hljs-params">(Expression* expression)</span></span>{

    <span class="hljs-comment">//&#x91CA;&#x653E;&#x8868;&#x8FBE;&#x5F0F;&#x6811;&#x7684;&#x8282;&#x70B9;&#x5185;&#x5B58;...</span>
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> * argv[])</span> </span>{

    <span class="hljs-built_in">string</span> expStr = <span class="hljs-string">&quot;a+b-c+d-e&quot;</span>;
    <span class="hljs-built_in">map</span>&lt; <span class="hljs-keyword">char</span>, <span class="hljs-keyword">int</span>&gt; var;
    var.insert(make_pair(<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-number">5</span>));
    var.insert(make_pair(<span class="hljs-string">&apos;b&apos;</span>,<span class="hljs-number">2</span>));
    var.insert(make_pair(<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-number">1</span>));
    var.insert(make_pair(<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-number">6</span>));
    var.insert(make_pair(<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-number">10</span>));

    Expression* expression= analyse(expStr);

    <span class="hljs-keyword">int</span> result=expression-&gt;interpreter(var);

    <span class="hljs-built_in">cout</span> &lt;&lt; result &lt;&lt; <span class="hljs-built_in">endl</span>;

    release(expression);

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">// &#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x5F0F;&#x89E3;&#x51B3;&#x7B80;&#x5355;&#x7684;&#x6587;&#x6CD5;&#x8868;&#x793A;&#xFF1A;</span>
<span class="hljs-comment">// &#x4F8B;&#x5982;&#xFF1A;</span>
<span class="hljs-comment">//     string s1=&quot;&#x8086;&#x4EDF;&#x53C1;&#x4F70;&#x4F0D;&#x62FE;&#x9646;&quot; &#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x5B57;</span>
</code></pre>
<h1 id="&#x5176;&#x4ED6;">&#x5176;&#x4ED6;</h1>
<ul>
<li><p>UML&#x7C7B;&#x56FE;&#x5B66;&#x4E60;&#x94FE;&#x63A5;&#xFF1A;
  <a href="http://www.uml.org.cn/oobject/201211231.asp" target="_blank">http://www.uml.org.cn/oobject/201211231.asp</a></p>
<p>&#x603B;&#x7ED3;&#x5404;&#x7C7B;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x7684;&#x7C7B;&#x56FE;</p>
</li>
<li><p>&#x5DE5;&#x5382;&#x65B9;&#x6CD5;+&#x5DE5;&#x5382;&#x6A21;&#x5F0F;+&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7684;&#x533A;&#x522B;&#xFF1A;
  <a href="https://blog.csdn.net/jerry11112/article/details/80618420" target="_blank">https://blog.csdn.net/jerry11112/article/details/80618420</a></p>
</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="正则表达式.html" class="navigation navigation-prev " aria-label="Previous page: 正则表达式">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../4工具类/" class="navigation navigation-next " aria-label="Next page: 第四章--工具类">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"设计模式","level":"1.5.14","depth":2,"next":{"title":"第四章--工具类","level":"1.6","depth":1,"path":"4工具类/README.md","ref":"4工具类/README.md","articles":[{"title":"vscode使用","level":"1.6.1","depth":2,"path":"4工具类/vscode使用.md","ref":"./4工具类/vscode使用.md","articles":[]},{"title":"markdown语法","level":"1.6.2","depth":2,"path":"4工具类/markdown语法.md","ref":"./4工具类/markdown语法.md","articles":[]}]},"previous":{"title":"正则表达式","level":"1.5.13","depth":2,"path":"3算法类/正则表达式.md","ref":"./3算法类/正则表达式.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"3算法类/设计模式.md","mtime":"2020-01-22T09:42:59.556Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-02-03T03:06:49.268Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

